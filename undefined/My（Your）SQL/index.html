<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">My（Your）SQL | 欢迎来到Franの杂货铺</title>
  
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <meta name="browsermode" content="application">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "KitholtFrank";
  mashiro_option.author_name = "Frank";
  mashiro_option.site_url = "https://kitholt.github.io/";
  mashiro_option.v_appId = "vK4njxg3C8GQOr9L6M8Hav7x-gzGzoHsz";
  mashiro_option.v_appKey = "e9eG1y4IcG54g4l676M1xeWQ";
  mashiro_option.mathjax = "0";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
  var bg = "https://cdn.jsdelivr.net/gh/kitholt/cdn/img/warriors.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/best.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/curry.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/chase.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/stadium.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/splashbros.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/coolkt.webp,".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配哦~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}
  </style>
</head>
</html>
<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop filter-dim">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="https://kitholt.github.io/">
          <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt3.jpeg">
        </a>
      </div>
      <div class="header-info">
        <p>你来啦!欢迎来到Franの杂货铺！</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="http://github.com/kitholt" target="_blank" class="social-github" title="github">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialgithub.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://weibo.com/u/7188904314" target="_blank" class="social-github" title="sina">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialsina.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://music.163.com/#/my/m/music/playlist?id=890672374" target="_blank" class="social-github" title="wangyiyun">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialwangyiyun.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://www.zhihu.com/people/frank-41-24-53" target="_blank" class="social-github" title="zhihu">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialzhihu.png">
                  </a>
                </li>
              
            
              
                <li class="wechat">
                  <a href="/#">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialwechat.png">
                  </a>
                  <div class="wechatInner">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialQR.jpg">
                  </div>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono">Kitholt</span>
            <span class="shironeko">Frank</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/categories/技术/">
                          <i class="fa fa-code" aria-hidden="true"></i>
                          技术
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/生活/">
                          <i class="fa fa-file-text-o" aria-hidden="true"></i>
                          生活
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/资源/">
                          <i class="fa fa-cloud-download" aria-hidden="true"></i>
                          资源
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="javascript:;">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
                    清单
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/music/">
                          <i class="fa fa-headphones" aria-hidden="true"></i>
                          歌单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/bangumi/">
                          <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                          番组
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/comment/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
                    留言板
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/donate/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
                    资瓷
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    关于
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/about/">
                          <i class="fa fa-meetup" aria-hidden="true"></i>
                          我？
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

  <div class="pattern-center single-center">
    <!-- 有配图默认渲染第一张 -->
    <div class="pattern-attachment-img lazyload" style="background-image: url(https://cdn.jsdelivr.net/gh/kitholt/cdn/img/brokenHeart.jpg);" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/brokenHeart.jpg">
    </div>
    <header class="pattern-header single-header">
      <h1 class="entry-title">
      My（Your）SQL</h1>
      <p class="entry-census">
        <span>
          <a href="">
            <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt3.jpeg">
          </a>
        </span>
        <span>
          <a href=""></a>
        </span>
        <span class="bull">
        ·</span>
        2022-10-26<span class="bull">
        ·</span>
      <span id="busuanzi_value_page_pv"></span>次阅读</p>
    </header>
  </div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
        <div class="entry-content">
          <h1 id="My（Your）SQL"><a href="#My（Your）SQL" class="headerlink" title="My（Your）SQL"></a>My（Your）SQL</h1><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="数值"><a href="#数值" class="headerlink" title="数值"></a>数值</h3><table>
<thead>
<tr>
<th style="text-align:left"><strong>类型</strong></th>
<th style="text-align:left"><strong>大小</strong></th>
<th style="text-align:left"><strong>范围（有符号）</strong></th>
<th style="text-align:left"><strong>范围（无符号）</strong></th>
<th style="text-align:left"><strong>用途</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">TINYINT</td>
<td style="text-align:left">1 字节</td>
<td style="text-align:left">(-128，127)</td>
<td style="text-align:left">(0，255)</td>
<td style="text-align:left">小整数值</td>
</tr>
<tr>
<td style="text-align:left">SMALLINT</td>
<td style="text-align:left">2 字节</td>
<td style="text-align:left">(-32 768，32 767)</td>
<td style="text-align:left">(0，65 535)</td>
<td style="text-align:left">大整数值</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMINT</td>
<td style="text-align:left">3 字节</td>
<td style="text-align:left">(-8 388 608，8 388 607)</td>
<td style="text-align:left">(0，16 777 215)</td>
<td style="text-align:left">大整数值</td>
</tr>
<tr>
<td style="text-align:left">INT或INTEGER</td>
<td style="text-align:left">4 字节</td>
<td style="text-align:left">(-2 147 483 648，2 147 483 647)</td>
<td style="text-align:left">(0，4 294 967 295)</td>
<td style="text-align:left">大整数值</td>
</tr>
<tr>
<td style="text-align:left">BIGINT</td>
<td style="text-align:left">8 字节</td>
<td style="text-align:left">(-9 233 372 036 854 775 808，9 223 372 036 854 775 807)</td>
<td style="text-align:left">(0，18 446 744 073 709 551 615)</td>
<td style="text-align:left">极大整数值</td>
</tr>
<tr>
<td style="text-align:left">FLOAT</td>
<td style="text-align:left">4 字节</td>
<td style="text-align:left">(-3.402 823 466 E+38，-1.175 494 351 E-38)，0，(1.175 494 351 E-38，3.402 823 466 351 E+38)</td>
<td style="text-align:left">0，(1.175 494 351 E-38，3.402 823 466 E+38)</td>
<td style="text-align:left">单精度 浮点数值</td>
</tr>
<tr>
<td style="text-align:left">DOUBLE</td>
<td style="text-align:left">8 字节</td>
<td style="text-align:left">(-1.797 693 134 862 315 7 E+308，-2.225 073 858 507 201 4 E-308)，0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308)</td>
<td style="text-align:left">0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308)</td>
<td style="text-align:left">双精度 浮点数值</td>
</tr>
<tr>
<td style="text-align:left">DECIMAL</td>
<td style="text-align:left">对DECIMAL(M,D) ，如果M&gt;D，为M+2否则为D+2</td>
<td style="text-align:left">依赖于M和D的值</td>
<td style="text-align:left">依赖于M和D的值</td>
<td style="text-align:left">小数值</td>
</tr>
</tbody>
</table>
<h3 id="日期"><a href="#日期" class="headerlink" title="日期"></a>日期</h3><table>
<thead>
<tr>
<th style="text-align:left">类型</th>
<th style="text-align:left">大小 (字节)</th>
<th style="text-align:left">范围</th>
<th style="text-align:left">格式</th>
<th style="text-align:left">用途</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">DATE</td>
<td style="text-align:left">3</td>
<td style="text-align:left">1000-01-01/9999-12-31</td>
<td style="text-align:left">YYYY-MM-DD</td>
<td style="text-align:left">日期值</td>
</tr>
<tr>
<td style="text-align:left">TIME</td>
<td style="text-align:left">3</td>
<td style="text-align:left">‘-838:59:59’/‘838:59:59’</td>
<td style="text-align:left">HH:MM:SS</td>
<td style="text-align:left">时间值或持续时间</td>
</tr>
<tr>
<td style="text-align:left">YEAR</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1901/2155</td>
<td style="text-align:left">YYYY</td>
<td style="text-align:left">年份值</td>
</tr>
<tr>
<td style="text-align:left">DATETIME</td>
<td style="text-align:left">8</td>
<td style="text-align:left">1000-01-01 00:00:00/9999-12-31 23:59:59</td>
<td style="text-align:left">YYYY-MM-DD HH:MM:SS</td>
<td style="text-align:left">混合日期和时间值</td>
</tr>
<tr>
<td style="text-align:left">TIMESTAMP</td>
<td style="text-align:left">4</td>
<td style="text-align:left">1970-01-01 00:00:00/2038 结束时间是第 2147483647 秒，北京时间 2038-1-19 11:14:07，格林尼治时间 2038-1-19 03:14:07</td>
<td style="text-align:left">YYYYMMDD HHMMSS</td>
<td style="text-align:left">混合日期和时间值，时间戳</td>
</tr>
</tbody>
</table>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><table>
<thead>
<tr>
<th style="text-align:left">类型</th>
<th style="text-align:left">大小</th>
<th style="text-align:left">用途</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><em>CHAR</em></td>
<td style="text-align:left"><em>0-255字节</em></td>
<td style="text-align:left"><em>定长字符串</em></td>
</tr>
<tr>
<td style="text-align:left"><em>VARCHAR</em></td>
<td style="text-align:left"><em>0-65535 字节</em></td>
<td style="text-align:left"><em>变长字符串</em></td>
</tr>
<tr>
<td style="text-align:left">TINYBLOB</td>
<td style="text-align:left">0-255字节</td>
<td style="text-align:left">不超过 255 个字符的二进制字符串</td>
</tr>
<tr>
<td style="text-align:left">TINYTEXT</td>
<td style="text-align:left">0-255字节</td>
<td style="text-align:left">短文本字符串</td>
</tr>
<tr>
<td style="text-align:left">BLOB</td>
<td style="text-align:left">0-65 535字节</td>
<td style="text-align:left">二进制形式的长文本数据</td>
</tr>
<tr>
<td style="text-align:left">TEXT</td>
<td style="text-align:left">0-65 535字节</td>
<td style="text-align:left">长文本数据</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMBLOB</td>
<td style="text-align:left">0-16 777 215字节</td>
<td style="text-align:left">二进制形式的中等长度文本数据</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMTEXT</td>
<td style="text-align:left">0-16 777 215字节</td>
<td style="text-align:left">中等长度文本数据</td>
</tr>
<tr>
<td style="text-align:left">LONGBLOB</td>
<td style="text-align:left">0-4 294 967 295字节</td>
<td style="text-align:left">二进制形式的极大文本数据</td>
</tr>
<tr>
<td style="text-align:left">LONGTEXT</td>
<td style="text-align:left">0-4 294 967 295字节</td>
<td style="text-align:left">极大文本数据</td>
</tr>
</tbody>
</table>
<p>CHAR 和 VARCHAR:</p>
<p>CHAR在定义时会限定存储空间大小，比如一开始规定5个字符。后续如果只给定2个字符，CHAR会自动用空格补齐。</p>
<p>CHAR浪费存储空间，但效率高，VARCHAR则反之</p>
<h2 id="使用数据库的基（只因）本语法"><a href="#使用数据库的基（只因）本语法" class="headerlink" title="使用数据库的基（只因）本语法"></a>使用数据库的基（只因）本语法</h2><p>数据库、表（增删改查）略</p>
<ol>
<li>插入：insert into…values</li>
<li>更新：update…set column_name = …</li>
<li>删除(不完全删除）：delete from…[where…]</li>
<li>删除（完全删除）：truncate…</li>
</ol>
<h2 id="with-rollup"><a href="#with-rollup" class="headerlink" title="with rollup"></a>with rollup</h2><p>WITH ROLLUP 可以实现在分组统计数据基础上再进行相同的统计（SUM,AVG,COUNT…）</p>
<h2 id="coalesce函数"><a href="#coalesce函数" class="headerlink" title="coalesce函数"></a>coalesce函数</h2><p>参数说明：如果a==null,则选择b；如果b==null,则选择c；如果a!=null,则选择a；如果a b c 都为null ，则返回为null（没意义）。</p>
<h2 id="MySQL-连接的使用"><a href="#MySQL-连接的使用" class="headerlink" title="MySQL 连接的使用"></a>MySQL 连接的使用</h2><p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/cdn/your_sql/sql_joins.jpg" alt></p>
<p> 外连接：</p>
<ul>
<li>左外连接【left join】两表连接，返回满足连接条件的行，并且返回左表中不满足的条件的行</li>
<li>右外连接【right join】</li>
<li>满外连接【full outer join】</li>
</ul>
<h2 id="事务—多条数据操作语句构成的集合"><a href="#事务—多条数据操作语句构成的集合" class="headerlink" title="事务—多条数据操作语句构成的集合"></a>事务—多条数据操作语句构成的集合</h2><ul>
<li><p>A（原子性—要么完成要么撤回，如果出错会回滚到事务开始前的状态</p>
</li>
<li><p>C（一致性—事务开始和结束后，数据库的完整性都没被破坏（前后数据不会矛盾</p>
</li>
<li><p>I（隔离性—允许多个事务并发执行，对数据进行读写修改</p>
</li>
<li><p>D（持久性—事务处理结束后对数据的修改是永久的</p>
</li>
</ul>
<h2 id="存储过程（stored-procedure"><a href="#存储过程（stored-procedure" class="headerlink" title="存储过程（stored procedure"></a>存储过程（stored procedure</h2><p>一组经过预先编译的SQL语句的封装</p>
<p>优：</p>
<ol>
<li>简化操作，提高重用性</li>
<li>减少网络传输量（因为语句都保存在MySQL服务器上</li>
<li>提高查询安全性，客户端只需要发送查询请求</li>
</ol>
<h2 id="存储引擎innoDB"><a href="#存储引擎innoDB" class="headerlink" title="存储引擎innoDB"></a>存储引擎innoDB</h2><h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><p>用于快速查找数据记录的数据结构</p>
<p>优</p>
<ul>
<li>减少磁盘io次数，加快查询效率</li>
<li>加快表与表之间的连接</li>
<li>减少分组和排序的时间</li>
</ul>
<p>劣</p>
<ul>
<li>创建索引和维护需要时间</li>
<li>会降低表的更新速度（因为每次进行数据操作时，除了更新数据，还要更新索引）</li>
</ul>
<h3 id="一个简单的索引结构"><a href="#一个简单的索引结构" class="headerlink" title="一个简单的索引结构"></a>一个简单的索引结构</h3><p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/cdn/your_sql/index.png" alt></p>
<h3 id="B-树-数据页（叶子节点）-目录页（内节点）"><a href="#B-树-数据页（叶子节点）-目录页（内节点）" class="headerlink" title="B+树 = 数据页（叶子节点） + 目录页（内节点）"></a>B+树 = 数据页（叶子节点） + 目录页（内节点）</h3><ul>
<li>B+树层数一般不超过4</li>
<li>B+树层数越少，IO次数越少</li>
</ul>
<h3 id="索引分类"><a href="#索引分类" class="headerlink" title="索引分类"></a>索引分类</h3><ol>
<li><p>聚簇索引</p>
<p>也叫簇类索引，是一种对磁盘上实际数据重新组织以按指定的一个或多个列的值排序。由于聚簇索引的索引页面指针指向数据页面，所以使用聚簇索引查找数据几乎总是比使用非聚簇索引快。<strong>一张表只能有一个聚簇索引，一般由主键构成</strong></p>
<p><span style="color:red; font-size:20px">索引即数据，数据即索引</span></p>
<p>叶子节点存储了全部数据列</p>
</li>
<li><p>二级索引（非聚簇索引）</p>
<p>叶子节点存储了【一个主键以外的列+主键值】，因此使用二级索引查找数据时，最后会进行<strong>回表</strong>操作（再通过主键值进行一次聚簇索引查找</p>
</li>
<li><p>联合索引</p>
<p>叶子节点存储了【多个主键以外的列+主键值】</p>
</li>
</ol>
<h3 id="关于索引的操作"><a href="#关于索引的操作" class="headerlink" title="关于索引的操作"></a>关于索引的操作</h3><ol>
<li>create [索引类型] [索引名称] on [表名] (列名)</li>
<li>drop index [索引名称] on [表名]</li>
</ol>
<h1 id="SQL题（由易到难）"><a href="#SQL题（由易到难）" class="headerlink" title="SQL题（由易到难）"></a>SQL题（由易到难）</h1><h3 id="1-题目："><a href="#1-题目：" class="headerlink" title="1. 题目："></a>1. 题目：</h3><p>现在运营需要查看用户来自于哪些学校，请从用户信息表中取出学校的去重数据。</p>
<p>   distinct关键字的使用</p>
<h3 id="2-题目："><a href="#2-题目：" class="headerlink" title="2. 题目："></a>2. 题目：</h3><p>现在运营只需要查看前2个用户明细设备ID数据，请你从用户信息表 user_profile 中取出相应结果。</p>
<p>   limit关键字的使用</p>
<h3 id="3-题目："><a href="#3-题目：" class="headerlink" title="3. 题目："></a>3. 题目：</h3><p>现在你需要查看前2个用户明细设备ID数据，并将列名改为 ‘user_infos_example’,，请你从用户信息表取出相应结果。</p>
<p>   as关键字的使用</p>
<h3 id="4-题目："><a href="#4-题目：" class="headerlink" title="4. 题目："></a>4. 题目：</h3><p>现在运营想要取出用户信息表中对应的数据，并先按照gpa、年龄降（升）序排序输出，请取出相应数据。</p>
<p>   asc和desc的使用</p>
<h3 id="5-题目："><a href="#5-题目：" class="headerlink" title="5. 题目："></a>5. 题目：</h3><p>现在运营想要对用户的年龄分布开展分析，在分析时想要剔除没有获取到年龄的用户，请你取出所有年龄值不为空的用户的设备ID，性别，年龄，学校的信息。</p>
<p>   where过滤空值，使用is来判断是否为空</p>
<h3 id="6-题目："><a href="#6-题目：" class="headerlink" title="6. 题目："></a>6. 题目：</h3><p>现在运营想要对每个学校不同性别的用户活跃情况和发帖数量进行分析，请分别计算出每个学校每种性别的用户数、30天内平均活跃天数和平均发帖数量。**</p>
<table>
<thead>
<tr>
<th>id</th>
<th>device_id</th>
<th>gender</th>
<th>age</th>
<th>university</th>
<th>gpa</th>
<th>active_days_within_30</th>
<th>question_cnt</th>
<th>answer_cnt</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2138</td>
<td>male</td>
<td>21</td>
<td>北京大学</td>
<td>3.4</td>
<td>7</td>
<td>2</td>
<td>12</td>
</tr>
<tr>
<td>2</td>
<td>3214</td>
<td>male</td>
<td></td>
<td>复旦大学</td>
<td>4.0</td>
<td>15</td>
<td>5</td>
<td>25</td>
</tr>
<tr>
<td>3</td>
<td>6543</td>
<td>female</td>
<td>20</td>
<td>北京大学</td>
<td>3.2</td>
<td>12</td>
<td>3</td>
<td>30</td>
</tr>
<tr>
<td>4</td>
<td>2315</td>
<td>female</td>
<td>23</td>
<td>浙江大学</td>
<td>3.6</td>
<td>5</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>5432</td>
<td>male</td>
<td>25</td>
<td>山东大学</td>
<td>3.8</td>
<td>20</td>
<td>15</td>
<td>70</td>
</tr>
<tr>
<td>6</td>
<td>2131</td>
<td>male</td>
<td>28</td>
<td>山东大学</td>
<td>3.3</td>
<td>15</td>
<td>7</td>
<td>13</td>
</tr>
<tr>
<td>7</td>
<td>4321</td>
<td>male</td>
<td>26</td>
<td>复旦大学</td>
<td>3.6</td>
<td>9</td>
<td>6</td>
<td>52</td>
</tr>
</tbody>
</table>
<pre><code class="mysql">select
  gender,
  university,
  count(device_id) as user_num,
  avg(active_days_within_30) as avg_active_days,
  avg(question_cnt) as avg_question_cnt
from
  user_profile
group by
  gender,
  university
</code></pre>
<h3 id="7-题目："><a href="#7-题目：" class="headerlink" title="7. 题目："></a>7. 题目：</h3><p>现在运营想查看每个学校用户的平均发贴和回帖情况，寻找低活跃度学校进行重点运营，请取出平均发贴数低于5的学校或平均回帖数小于20的学校。</p>
<pre><code class="mysql">   select
       university, avg(question_cnt) as avg_question_cnt, avg(answer_cnt) as avg_answer_cnt
   from
       user_profile
   group by
       university
   having
       avg(question_cnt) &lt; 5 or avg(answer_cnt) &lt; 20
</code></pre>
<p>   我的错误点：一开始使用了where</p>
<p>   university having</p>
<p>​        使用HAVING<br>​        HAVING子句用于对分组后的结果再进行过滤，<br>​        它的功能有点像WHERE子句，但它用于组而不是单个记录。<br>​        <strong>在HAVING子句中可以使用统计函数，但在WHERE子句中则不能。<br>​        HAVING通常与GROUP BY子句一起使用。</strong></p>
<h3 id="8-题目："><a href="#8-题目：" class="headerlink" title="8. 题目："></a>8. 题目：</h3><p>运营想要计算一些<strong>参加了答题</strong>的不同学校、不同难度的用户平均答题量，请你写SQL取出相应数据</p>
<p>   用户信息表：user_profile</p>
<table>
<thead>
<tr>
<th>id</th>
<th>device_id</th>
<th>gender</th>
<th>age</th>
<th>university</th>
<th>gpa</th>
<th>active_days_within_30</th>
<th>question_cnt</th>
<th>answer_cnt</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2138</td>
<td>male</td>
<td>21</td>
<td>北京大学</td>
<td>3.4</td>
<td>7</td>
<td>2</td>
<td>12</td>
</tr>
<tr>
<td>2</td>
<td>3214</td>
<td>male</td>
<td>NULL</td>
<td>复旦大学</td>
<td>4</td>
<td>15</td>
<td>5</td>
<td>25</td>
</tr>
<tr>
<td>3</td>
<td>6543</td>
<td>female</td>
<td>20</td>
<td>北京大学</td>
<td>3.2</td>
<td>12</td>
<td>3</td>
<td>30</td>
</tr>
<tr>
<td>4</td>
<td>2315</td>
<td>female</td>
<td>23</td>
<td>浙江大学</td>
<td>3.6</td>
<td>5</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>5432</td>
<td>male</td>
<td>25</td>
<td>山东大学</td>
<td>3.8</td>
<td>20</td>
<td>15</td>
<td>70</td>
</tr>
<tr>
<td>6</td>
<td>2131</td>
<td>male</td>
<td>28</td>
<td>山东大学</td>
<td>3.3</td>
<td>15</td>
<td>7</td>
<td>13</td>
</tr>
<tr>
<td>7</td>
<td>4321</td>
<td>male</td>
<td>28</td>
<td>复旦大学</td>
<td>3.6</td>
<td>9</td>
<td>6</td>
<td>52</td>
</tr>
</tbody>
</table>
<p>​    题库练习明细表：question_practice_detail</p>
<table>
<thead>
<tr>
<th>id</th>
<th>device_id</th>
<th>question_id</th>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2138</td>
<td>111</td>
<td>wrong</td>
</tr>
<tr>
<td>2</td>
<td>3214</td>
<td>112</td>
<td>wrong</td>
</tr>
<tr>
<td>3</td>
<td>3214</td>
<td>113</td>
<td>wrong</td>
</tr>
<tr>
<td>4</td>
<td>6534</td>
<td>111</td>
<td>right</td>
</tr>
<tr>
<td>5</td>
<td>2315</td>
<td>115</td>
<td>right</td>
</tr>
<tr>
<td>6</td>
<td>2315</td>
<td>116</td>
<td>right</td>
</tr>
<tr>
<td>7</td>
<td>2315</td>
<td>117</td>
<td>wrong</td>
</tr>
<tr>
<td>8</td>
<td>5432</td>
<td>117</td>
<td>wrong</td>
</tr>
<tr>
<td>9</td>
<td>5432</td>
<td>112</td>
<td>wrong</td>
</tr>
<tr>
<td>10</td>
<td>2131</td>
<td>113</td>
<td>right</td>
</tr>
<tr>
<td>11</td>
<td>5432</td>
<td>113</td>
<td>wrong</td>
</tr>
<tr>
<td>12</td>
<td>2315</td>
<td>115</td>
<td>right</td>
</tr>
<tr>
<td>13</td>
<td>2315</td>
<td>116</td>
<td>right</td>
</tr>
<tr>
<td>14</td>
<td>2315</td>
<td>117</td>
<td>wrong</td>
</tr>
<tr>
<td>15</td>
<td>5432</td>
<td>117</td>
<td>wrong</td>
</tr>
<tr>
<td>16</td>
<td>5432</td>
<td>112</td>
<td>wrong</td>
</tr>
<tr>
<td>17</td>
<td>2131</td>
<td>113</td>
<td>right</td>
</tr>
<tr>
<td>18</td>
<td>5432</td>
<td>113</td>
<td>wrong</td>
</tr>
<tr>
<td>19</td>
<td>2315</td>
<td>117</td>
<td>wrong</td>
</tr>
<tr>
<td>20</td>
<td>5432</td>
<td>117</td>
<td>wrong</td>
</tr>
<tr>
<td>21</td>
<td>5432</td>
<td>112</td>
<td>wrong</td>
</tr>
<tr>
<td>22</td>
<td>2131</td>
<td>113</td>
<td>right</td>
</tr>
<tr>
<td>23</td>
<td>5432</td>
<td>113</td>
<td>wrong</td>
</tr>
</tbody>
</table>
<p>​    问题细节表：question_detail</p>
<table>
<thead>
<tr>
<th>id</th>
<th>question_id</th>
<th>difficult_level</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>111</td>
<td>hard</td>
</tr>
<tr>
<td>2</td>
<td>112</td>
<td>medium</td>
</tr>
<tr>
<td>3</td>
<td>113</td>
<td>easy</td>
</tr>
<tr>
<td>4</td>
<td>115</td>
<td>easy</td>
</tr>
<tr>
<td>5</td>
<td>116</td>
<td>medium</td>
</tr>
<tr>
<td>6</td>
<td>117</td>
<td>easy</td>
</tr>
</tbody>
</table>
<p>应该返回的结果：</p>
<table>
<thead>
<tr>
<th>university</th>
<th>difficult_level</th>
<th>avg_answer_cnt</th>
</tr>
</thead>
<tbody>
<tr>
<td>北京大学</td>
<td>hard</td>
<td>1.0000</td>
</tr>
<tr>
<td>复旦大学</td>
<td>easy</td>
<td>1.0000</td>
</tr>
<tr>
<td>复旦大学</td>
<td>medium</td>
<td>1.0000</td>
</tr>
<tr>
<td>山东大学</td>
<td>easy</td>
<td>4.5000</td>
</tr>
<tr>
<td>山东大学</td>
<td>medium</td>
<td>3.0000</td>
</tr>
<tr>
<td>浙江大学</td>
<td>easy</td>
<td>5.0000</td>
</tr>
<tr>
<td>浙江大学</td>
<td>medium</td>
<td>2.0000</td>
</tr>
</tbody>
</table>
<pre><code class="mysql">select
  up.university,
  qd.difficult_level,
  count(qd.question_id) / count(distinct up.device_id) as avg_answer_cnt
from
  user_profile as up
  inner join question_practice_detail as qpd on up.device_id = qpd.device_id
  inner join question_detail as qd on qpd.question_id = qd.question_id
group by
  up.university, qd.difficult_level
</code></pre>
<h3 id="9-题目："><a href="#9-题目：" class="headerlink" title="9. 题目："></a>9. 题目：</h3><p>运营想要查看<strong>参加了答题</strong>的山东大学的用户在不同难度下的平均答题题目数，请取出相应数据</p>
<ul>
<li>山东大学的用户</li>
<li>不同难度</li>
<li>平均答题题目数</li>
</ul>
<pre><code class="mysql">select 
    &quot;山东大学&quot; as university,
    difficult_level,
    count(qpd.question_id) / count(distinct qpd.device_id) as avg_answer_cnt
from question_practice_detail as qpd

inner join user_profile as up
on up.device_id=qpd.device_id and up.university=&quot;山东大学&quot;

inner join question_detail as qd
on qd.question_id=qpd.question_id
</code></pre>
<h3 id="10-题目："><a href="#10-题目：" class="headerlink" title="10. 题目："></a>10. 题目：</h3><p>现在运营想要分别查看学校为山东大学或者性别为男性的用户的device_id、gender、age和gpa数据，请取出相应结果，<strong>结果不去重</strong>。</p>
<p>​    <span style="color:red;font-size: 20px">结果不去重，需要使用到union all</span></p>
<ul>
<li><p>union 和union all的区别</p>
</li>
<li><p>union是合并两个查询语句的结果集，并排除重复项</p>
</li>
<li>union all是不排除重复项的，（符合题目要求）</li>
</ul>
<ol>
<li>union使用前提</li>
</ol>
<ul>
<li>使用union合并两个表时，需要两个表的结果集字段完全一样；</li>
<li>表一（SELECT device_id,gender,age,gpa ）;</li>
<li>表二（SELECT device_id,gender,age,gpa）</li>
</ul>
<hr>
<h3 id="11-题目："><a href="#11-题目：" class="headerlink" title="11. 题目："></a>11. 题目：</h3><p>现在运营想要查看用户在某天刷题后第二天还会再来刷题的平均概率。请你取出相应数据。</p>
<table>
<thead>
<tr>
<th>id</th>
<th>device_id</th>
<th>quest_id</th>
<th>result</th>
<th>date</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2138</td>
<td>111</td>
<td>wrong</td>
<td>2021-05-03</td>
</tr>
<tr>
<td>2</td>
<td>3214</td>
<td>112</td>
<td>wrong</td>
<td>2021-05-09</td>
</tr>
<tr>
<td>3</td>
<td>3214</td>
<td>113</td>
<td>wrong</td>
<td>2021-06-15</td>
</tr>
<tr>
<td>4</td>
<td>6543</td>
<td>111</td>
<td>right</td>
<td>2021-08-13</td>
</tr>
<tr>
<td>5</td>
<td>2315</td>
<td>115</td>
<td>right</td>
<td>2021-08-13</td>
</tr>
<tr>
<td>6</td>
<td>2315</td>
<td>116</td>
<td>right</td>
<td>2021-08-14</td>
</tr>
<tr>
<td>7</td>
<td>2315</td>
<td>117</td>
<td>wrong</td>
<td>2021-08-15</td>
</tr>
</tbody>
</table>
<p>思路：</p>
<ul>
<li><p>原表a，复制一份表b</p>
</li>
<li><p>先去重（有可能一个用户一天刷多次题</p>
</li>
<li>表b的时间全部+1（day<ul>
<li>需要使用的方法——date_add(date,interval 1 day)</li>
</ul>
</li>
<li>如果第二天还会来刷题，那么两个表左外连接的结果就是：连续两天刷题的行数据没有null值出现</li>
<li>某天刷题后第二天还会再来刷题的平均概率：统计非null的行/所有行</li>
</ul>
<pre><code class="mysql">select avg(if(b.device_id is not null,1,0)) as avg_ret
from 
(select distinct device_id,date
from question_practice_detail
)a
left join 
(
select distinct device_id,date_add(date,interval 1 day) as date 
from question_practice_detail
)b
on a.device_id = b.device_id and a.date = b.date
</code></pre>
<h3 id="12-题目："><a href="#12-题目：" class="headerlink" title="12. 题目："></a>12. 题目：</h3><p>现在运营举办了一场比赛，收到了一些参赛申请，表数据记录形式如下所示，现在运营想要统计每个性别的用户分别有多少参赛者，请取出相应结果</p>
<table>
<thead>
<tr>
<th>device_id</th>
<th>profile</th>
<th>blog_url</th>
</tr>
</thead>
<tbody>
<tr>
<td>2138</td>
<td>180cm,75kg,27,male</td>
<td>http:/url/bigboy777</td>
</tr>
<tr>
<td>3214</td>
<td>165cm,45kg,26,female</td>
<td>http:/url/kittycc</td>
</tr>
<tr>
<td>6543</td>
<td>178cm,65kg,25,male</td>
<td>http:/url/tiger</td>
</tr>
<tr>
<td>4321</td>
<td>171cm,55kg,23,female</td>
<td>http:/url/uhksd</td>
</tr>
<tr>
<td>2131</td>
<td>168cm,45kg,22,female</td>
<td>http:/urlsydney</td>
</tr>
</tbody>
</table>
<p>观察：</p>
<p>很明显profile字段的存储类型是字符串，里面有多条信息。需要用到某些函数来实现字符串的分割</p>
<p>函数：</p>
<p><span style="color:red"><strong>substring_index(str, delim, count)</strong></span></p>
<ul>
<li>str：要处理的字符串</li>
<li>delim：分隔符</li>
<li>count：计数<ul>
<li>如果count为正数n，就从左往右数，截取第n个分隔符的左边全部内容，n为负数的话，则反之</li>
</ul>
</li>
</ul>
<pre><code class="my">select
  substring_index(profile, &#39;,&#39;, -1) as gender,
  count(*) as number
from user_submit
group by
  gender
</code></pre>
<h3 id="13-题目："><a href="#13-题目：" class="headerlink" title="13.题目："></a>13.题目：</h3><p>现在运营想要找到每个学校gpa最低的同学来做调研，请你取出每个学校的最低gpa。</p>
<pre><code class="mysql">select
  device_id,
  university,
  min(gpa) as gpa
from
  user_profile
group by
  university
order by
  university
</code></pre>
<p>以上是错误的语句，此时得到的结果中，最低的gpa对应的device_id有可能不一致</p>
<p>解决方法：</p>
<ol>
<li>先根据原表（表a）拿到每个学校最低的gpa（表b</li>
<li>ab两表 内连接</li>
</ol>
<pre><code class="mysql">select
  a.device_id,
  b.university,
  b.gpa
from
  user_profile as a
  inner join (
    select
      university,
      min(gpa) as gpa
    from
      user_profile
    GROUP BY
      university
  ) as b
  on a.university = b.university and a.gpa = b.gpa
order by
a.university
</code></pre>
<h3 id="14-题目："><a href="#14-题目：" class="headerlink" title="14.题目："></a>14.题目：</h3><p>现在运营想要了解复旦大学的每个用户在8月份练习的总题目数和回答正确的题目数情况，请取出相应明细数据，对于在8月份没有练习过的用户，答题数结果返回0.</p>
<p>分析：</p>
<ol>
<li>学校限制：复旦大学—‘复旦大学’ as university</li>
<li>八月份的练习—month(b.date) = 8</li>
<li>8月份没有练习过的用户，答题数结果返回0—左连接</li>
<li>8月份练习的总题目数—count(b.question_id) as question_cnt</li>
<li>回答正确的题目数—sum(if(b.result = ‘right’, 1, 0)) as right_question_cnt</li>
</ol>
<pre><code class="mysql">select
  a.device_id,
  &#39;复旦大学&#39; as university,
  count(b.question_id) as question_cnt,
  sum(if(b.result = &#39;right&#39;, 1, 0)) as right_question_cnt
from
  user_profile as a
  left join question_practice_detail as b on a.device_id = b.device_id
  and month(b.date) = 8
where
  a.university = &#39;复旦大学&#39;
group by
  a.device_id
</code></pre>
<h3 id="15-题目："><a href="#15-题目：" class="headerlink" title="15.题目："></a>15.题目：</h3><p>现在运营想要了解<strong>浙江大学的用户在不同难度题目下答题的正确率情况</strong>，请取出相应数据，并按照准确率升序输出。</p>
<p>分析：</p>
<ol>
<li>答题正确率</li>
<li>不同难度下的题目</li>
<li>浙江大学</li>
<li>准确率升序输出</li>
</ol>
<pre><code class="mysql">select
  qd.difficult_level,
  sum(if(qpd.result = &#39;right&#39;, 1, 0)) / count(qpd.question_id) as correct_rate
from
  question_practice_detail as qpd
  inner join question_detail as qd on qpd.question_id = qd.question_id
where
  qpd.device_id in (
    select
      up.device_id
    from
      user_profile as up
    where
      up.university = &#39;浙江大学&#39;
  )
group by
  qd.difficult_level
order by
  correct_rate
</code></pre>
<h3 id="16-题目："><a href="#16-题目：" class="headerlink" title="16.题目："></a>16.题目：</h3><p>现有一张试卷作答记录表exam_record，其中包含多年来的用户作答试卷记录，结构如下表：</p>
<p>作答记录表exam_record：</p>
<p>start_time是试卷开始时间</p>
<p>submit_time 是交卷，即结束时间</p>
<table>
<thead>
<tr>
<th>Filed</th>
<th>Type</th>
<th>Null</th>
<th>Key</th>
<th>Extra</th>
<th>Default</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int(11)</td>
<td>NO</td>
<td>PRI</td>
<td>auto_increment</td>
<td>(NULL)</td>
<td>自增ID</td>
</tr>
<tr>
<td>uid</td>
<td>int(11)</td>
<td>NO</td>
<td></td>
<td></td>
<td>(NULL)</td>
<td>用户ID</td>
</tr>
<tr>
<td>exam_id</td>
<td>int(11)</td>
<td>NO</td>
<td></td>
<td></td>
<td>(NULL)</td>
<td>试卷ID</td>
</tr>
<tr>
<td>start_time</td>
<td>datetime</td>
<td>NO</td>
<td></td>
<td></td>
<td>(NULL)</td>
<td>开始时间</td>
</tr>
<tr>
<td>submit_time</td>
<td>datetime</td>
<td>YES</td>
<td></td>
<td></td>
<td>(NULL)</td>
<td>提交时间</td>
</tr>
<tr>
<td>score</td>
<td>tinyint(4)</td>
<td>YES</td>
<td></td>
<td></td>
<td>(NULL)</td>
<td>得分</td>
</tr>
</tbody>
</table>
<p>请删除exam_record表中作答时间小于5分钟整且分数不及格（及格线为60分）的记录</p>
<p>分析：</p>
<p>计算时间差，需要用到的函数</p>
<ul>
<li>TIMESTAMPDIFF(interval, time_start, time_end)可计算time_start-time_end的时间差，单位以指定的interval为准，常用可选：<ul>
<li>SECOND 秒</li>
<li>MINUTE 分钟（返回秒数差除以60的整数部分）</li>
<li>HOUR 小时（返回秒数差除以3600的整数部分）</li>
<li>DAY 天数（返回秒数差除以3600*24的整数部分）</li>
<li>MONTH 月数</li>
<li>YEAR 年数</li>
</ul>
</li>
</ul>
<pre><code class="mysql">delete from
  exam_record
where
  timestampdiff(minute, start_time, submit_time) &lt; 5 and score &lt; 60
</code></pre>
<h3 id="17-题目："><a href="#17-题目：" class="headerlink" title="17.题目："></a>17.题目：</h3><p>牛客的运营同学想要查看大家在SQL类别中高难度试卷的得分情况。</p>
<p>请你帮她从exam_record数据表中计算所有用户完成<strong>SQL类别高难度试卷得分的截断平均值</strong>（去掉一个最大值和一个最小值后的平均值）。</p>
<p>示例数据：examination_info（exam_id试卷ID, tag试卷类别, difficulty试卷难度, duration考试时长, release_time发布时间）</p>
<table>
<thead>
<tr>
<th>id</th>
<th>exam_id</th>
<th>tag</th>
<th>difficulty</th>
<th>duration</th>
<th>release_time</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>9001</td>
<td>SQL</td>
<td>hard</td>
<td>60</td>
<td>2020-01-01 10:00:00</td>
</tr>
<tr>
<td>2</td>
<td>9002</td>
<td>算法</td>
<td>medium</td>
<td>80</td>
<td>2020-08-02 10:00:00</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>id</th>
<th>uid</th>
<th>exam_id</th>
<th>start_time</th>
<th>submit_time</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1001</td>
<td>9001</td>
<td>2020-01-02 09:01:01</td>
<td>2020-01-02 09:21:01</td>
<td>80</td>
</tr>
<tr>
<td>2</td>
<td>1001</td>
<td>9001</td>
<td>2021-05-02 10:01:01</td>
<td>2021-05-02 10:30:01</td>
<td>81</td>
</tr>
<tr>
<td>3</td>
<td>1001</td>
<td>9001</td>
<td>2021-06-02 19:01:01</td>
<td>2021-06-02 19:31:01</td>
<td>84</td>
</tr>
<tr>
<td>4</td>
<td>1001</td>
<td>9002</td>
<td>2021-09-05 19:01:01</td>
<td>2021-09-05 19:40:01</td>
<td>89</td>
</tr>
<tr>
<td>5</td>
<td>1001</td>
<td>9001</td>
<td>2021-09-02 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>6</td>
<td>1001</td>
<td>9002</td>
<td>2021-09-01 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>7</td>
<td>1002</td>
<td>9002</td>
<td>2021-02-02 19:01:01</td>
<td>2021-02-02 19:30:01</td>
<td>87</td>
</tr>
<tr>
<td>8</td>
<td>1002</td>
<td>9001</td>
<td>2021-05-05 18:01:01</td>
<td>2021-05-05 18:59:02</td>
<td>90</td>
</tr>
<tr>
<td>9</td>
<td>1003</td>
<td>9001</td>
<td>2021-09-07 12:01:01</td>
<td>2021-09-07 10:31:01</td>
<td>50</td>
</tr>
<tr>
<td>10</td>
<td>1004</td>
<td>9001</td>
<td>2021-09-06 10:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
</tbody>
</table>
<p>分析：</p>
<ol>
<li>SQL类别—where</li>
<li>高难度—where</li>
<li>截断平均值— round((sum(score) - max(score) - min(score)) / (count(score) - 2),1)</li>
</ol>
<pre><code class="mysql">select
  &#39;SQL&#39; as tag,
  ei.difficulty,
  round(
    (sum(score) - max(score) - min(score)) / (count(score) - 2),
    1
  ) as clip_avg_score
from
  examination_info as ei
  inner join exam_record as er on ei.exam_id = er.exam_id
where
  ei.difficulty = &#39;hard&#39;
  and ei.tag = &#39;SQL&#39;
group by
  er.exam_id
</code></pre>
<h3 id="18-题目："><a href="#18-题目：" class="headerlink" title="18.题目："></a>18.题目：</h3><p>请从试卷作答记录表中找到SQL试卷得分不小于该类试卷平均得分的用户最低得分。</p>
<p>示例数据 exam_record表（uid用户ID, exam_id试卷ID, start_time开始作答时间, submit_time交卷时间, score得分）：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>uid</th>
<th>exam_id</th>
<th>start_time</th>
<th>submit_time</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1001</td>
<td>9001</td>
<td>2020-01-02 09:01:01</td>
<td>2020-01-02 09:21:01</td>
<td>80</td>
</tr>
<tr>
<td>2</td>
<td>1002</td>
<td>9001</td>
<td>2021-09-05 19:01:01</td>
<td>2021-09-05 19:40:01</td>
<td>89</td>
</tr>
<tr>
<td>3</td>
<td>1002</td>
<td>9002</td>
<td>2021-09-02 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>4</td>
<td>1002</td>
<td>9003</td>
<td>2021-09-01 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>5</td>
<td>1002</td>
<td>9001</td>
<td>2021-02-02 19:01:01</td>
<td>2021-02-02 19:30:01</td>
<td>87</td>
</tr>
<tr>
<td>6</td>
<td>1002</td>
<td>9002</td>
<td>2021-05-05 18:01:01</td>
<td>2021-05-05 18:59:02</td>
<td>90</td>
</tr>
<tr>
<td>7</td>
<td>1003</td>
<td>9002</td>
<td>2021-02-06 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>8</td>
<td>1003</td>
<td>9003</td>
<td>2021-09-07 10:01:01</td>
<td>2021-09-07 10:31:01</td>
<td>86</td>
</tr>
<tr>
<td>9</td>
<td>1004</td>
<td>9003</td>
<td>2021-09-06 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>id</th>
<th>exam_id</th>
<th>tag</th>
<th>difficulty</th>
<th>duration</th>
<th>release_time</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>9001</td>
<td>SQL</td>
<td>hard</td>
<td>60</td>
<td>2020-01-01 10:00:00</td>
</tr>
<tr>
<td>2</td>
<td>9002</td>
<td>SQL</td>
<td>easy</td>
<td>60</td>
<td>2020-02-01 10:00:00</td>
</tr>
<tr>
<td>3</td>
<td>9003</td>
<td>算法</td>
<td>medium</td>
<td>80</td>
<td>2020-08-02 10:00:00</td>
</tr>
</tbody>
</table>
<pre><code class="mysql">select
  er.score as min_score_over_avg
from
  exam_record as er
where
  er.exam_id in (
    select
      ei.exam_id
    from
      examination_info as ei
    where
      tag = &#39;SQL&#39;
  )
  and er.score &gt;= (
    select
      avg(er.score)
    from
      exam_record as er
    where
      er.exam_id in (
        select
          ei.exam_id
        from
          examination_info as ei
        where
          tag = &#39;SQL&#39;
      )
  )
order by
  er.score
limit 1
</code></pre>
<h3 id="19-题目："><a href="#19-题目：" class="headerlink" title="19.题目："></a>19.题目：</h3><p>用户在牛客试卷作答区作答记录存储在表exam_record中，内容如下：</p>
<p>exam_record表（uid用户ID, exam_id试卷ID, start_time开始作答时间, submit_time交卷时间, score得分）</p>
<table>
<thead>
<tr>
<th>id</th>
<th>uid</th>
<th>exam_id</th>
<th>start_time</th>
<th>submit_time</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1001</td>
<td>9001</td>
<td>2021-07-02 09:01:01</td>
<td>2021-07-02 09:21:01</td>
<td>80</td>
</tr>
<tr>
<td>2</td>
<td>1002</td>
<td>9001</td>
<td>2021-09-05 19:01:01</td>
<td>2021-09-05 19:40:01</td>
<td>81</td>
</tr>
<tr>
<td>3</td>
<td>1002</td>
<td>9002</td>
<td>2021-09-02 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>4</td>
<td>1002</td>
<td>9003</td>
<td>2021-09-01 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>5</td>
<td>1002</td>
<td>9001</td>
<td>2021-07-02 19:01:01</td>
<td>2021-07-02 19:30:01</td>
<td>82</td>
</tr>
<tr>
<td>6</td>
<td>1002</td>
<td>9002</td>
<td>2021-07-05 18:01:01</td>
<td>2021-07-05 18:59:02</td>
<td>90</td>
</tr>
</tbody>
</table>
<p>请计算2021年每个月里试卷作答区用户平均月活跃天数avg_active_days和月度活跃人数mau，上面数据的示例输出如下：</p>
<table>
<thead>
<tr>
<th>month</th>
<th>avg_active_days</th>
<th>mau</th>
</tr>
</thead>
<tbody>
<tr>
<td>202107</td>
<td>1.50</td>
<td>2</td>
</tr>
<tr>
<td>202109</td>
<td>1.25</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>解释：2021年7月有2人活跃，共活跃了3天（1001活跃1天，1002活跃2天），平均活跃天数1.5；2021年9月有4人活跃，共活跃了5天，平均活跃天数1.25，结果保留2位小数。</p>
<p>注：此处活跃指有<strong>交卷行为</strong>。</p>
<p>分析：</p>
<ol>
<li><p>2021年每个月</p>
</li>
<li><p>用户平均月活跃天数—round((count(distinct uid, date_format(submit_time, ‘%y%m%d’))) / count(distinct uid),2)</p>
<ul>
<li><p>思路：</p>
<p>用户平均月活跃天数 = 该月活跃总天数 / 月度活跃总人数</p>
<p><span style="color:red">该月活跃总天数统计时，不能统计一天内有重复的uid（用户）且要求submit_time不能为null</span></p>
<p>因此要distinct去重</p>
</li>
</ul>
</li>
<li><p>月度活跃人数—count(distinct er.uid)</p>
</li>
</ol>
<pre><code class="mysql">select
  date_format(submit_time, &#39;%Y%m&#39;) as month,
  round(
    (
      count(distinct uid, date_format(submit_time, &#39;%y%m%d&#39;))
    ) / count(distinct uid),
    2
  ) as avg_active_days,
  count(distinct er.uid) as mau
from
  exam_record as er
where
  submit_time is not null
  and year(er.submit_time) = 2021
group by
  date_format(submit_time, &#39;%Y%m&#39;)
</code></pre>
<p>注意：</p>
<p><strong>round()函数的使用</strong></p>
<p><strong>date_format函数的使用</strong></p>
<p><strong>count函数的使用</strong></p>
<ul>
<li>count(distinct col) 计算该列除 NULL 之外的不重复行数,注意 count(distinct col1, col2) 如果其中一列全为 NULL,那么即使另一列有不同的值,也返回为 0</li>
</ul>
<h3 id="20-题目："><a href="#20-题目：" class="headerlink" title="20.题目："></a>20.题目：</h3><p>现有一张题目练习记录表practice_record，示例内容如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>uid</th>
<th>question_id</th>
<th>submit_time</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1001</td>
<td>8001</td>
<td>2021-08-02 11:41:01</td>
<td>60</td>
</tr>
<tr>
<td>2</td>
<td>1002</td>
<td>8001</td>
<td>2021-09-02 19:30:01</td>
<td>50</td>
</tr>
<tr>
<td>3</td>
<td>1002</td>
<td>8001</td>
<td>2021-09-02 19:20:01</td>
<td>70</td>
</tr>
<tr>
<td>4</td>
<td>1002</td>
<td>8002</td>
<td>2021-09-02 19:38:01</td>
<td>70</td>
</tr>
<tr>
<td>5</td>
<td>1003</td>
<td>8002</td>
<td>2021-08-01 19:38:01</td>
<td>80</td>
</tr>
</tbody>
</table>
<p>请从中统计出2021年每个月里用户的月总刷题数month_q_cnt 和日均刷题数avg_day_q_cnt（按月份升序排序）以及该年的总体情况，示例数据输出如下：</p>
<table>
<thead>
<tr>
<th>submit_month</th>
<th>month_q_cnt</th>
<th>avg_day_q_cnt</th>
</tr>
</thead>
<tbody>
<tr>
<td>202108</td>
<td>2</td>
<td>0.065</td>
</tr>
<tr>
<td>202109</td>
<td>3</td>
<td>0.100</td>
</tr>
<tr>
<td>2021汇总</td>
<td>5</td>
<td>0.161</td>
</tr>
</tbody>
</table>
<p>解释：2021年8月共有2次刷题记录，日均刷题数为2/31=0.065（保留3位小数）；2021年9月共有3次刷题记录，日均刷题数为3/30=0.100；2021年共有5次刷题记录（年度汇总平均无实际意义，这里我们按照31天来算5/31=0.161）</p>
<p>参考答案</p>
<pre><code class="mysql">select
  coalesce(year_mon, &#39;2021汇总&#39;) as submit_month,
  count(question_id) as month_q_cnt,
  round(count(question_id) / max(t.days_month), 3) as avg_day_cnt
from
  (
    select
      date_format(submit_time, &#39;%Y%m&#39;) as year_mon
      question_id,
      dayofmonth(last_day(submit_time)) as days_month,
    from
      practice_record
    where
      year(submit_time) = 2021
  ) as t
group by
  t.year_mon with rollup;
</code></pre>
<p><strong>dayofmonth函数的使用</strong></p>
<h3 id="21-题目："><a href="#21-题目：" class="headerlink" title="21. 题目："></a>21. 题目：</h3><p>现有试卷作答记录表exam_record（uid用户ID, exam_id试卷ID, start_time开始作答时间, submit_time交卷时间, score得分），示例数据如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>uid</th>
<th>exam_id</th>
<th>start_time</th>
<th>submit_time</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1001</td>
<td>9001</td>
<td>2021-07-02 09:01:01</td>
<td>2021-07-02 09:21:01</td>
<td>80</td>
</tr>
<tr>
<td>2</td>
<td>1002</td>
<td>9001</td>
<td>2021-09-05 19:01:01</td>
<td>2021-09-05 19:40:01</td>
<td>81</td>
</tr>
<tr>
<td>3</td>
<td>1002</td>
<td>9002</td>
<td>2021-09-02 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>4</td>
<td>1002</td>
<td>9003</td>
<td>2021-09-01 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>5</td>
<td>1002</td>
<td>9001</td>
<td>2021-07-02 19:01:01</td>
<td>2021-07-02 19:30:01</td>
<td>82</td>
</tr>
<tr>
<td>6</td>
<td>1002</td>
<td>9002</td>
<td>2021-07-05 18:01:01</td>
<td>2021-07-05 18:59:02</td>
<td>90</td>
</tr>
<tr>
<td>7</td>
<td>1003</td>
<td>9002</td>
<td>2021-07-06 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>8</td>
<td>1003</td>
<td>9003</td>
<td>2021-09-07 10:01:01</td>
<td>2021-09-07 10:31:01</td>
<td>86</td>
</tr>
<tr>
<td>9</td>
<td>1004</td>
<td>9003</td>
<td>2021-09-06 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>10</td>
<td>1002</td>
<td>9003</td>
<td>2021-09-01 12:01:01</td>
<td>2021-09-01 12:31:01</td>
<td>81</td>
</tr>
<tr>
<td>11</td>
<td>1005</td>
<td>9001</td>
<td>2021-09-01 12:01:01</td>
<td>2021-09-01 12:31:01</td>
<td>88</td>
</tr>
<tr>
<td>12</td>
<td>1005</td>
<td>9002</td>
<td>2021-09-01 12:01:01</td>
<td>2021-09-01 12:31:01</td>
<td>88</td>
</tr>
<tr>
<td>13</td>
<td>1006</td>
<td>9002</td>
<td>2021-09-02 12:11:01</td>
<td>2021-09-02 12:31:01</td>
<td>89</td>
</tr>
</tbody>
</table>
<p>还有一张试卷信息表examination_info（exam_id试卷ID, tag试卷类别, difficulty试卷难度, duration考试时长, release_time发布时间），示例数据如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>exam_id</th>
<th>tag</th>
<th>difficulty</th>
<th>duration</th>
<th>release_time</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>9001</td>
<td>SQL</td>
<td>hard</td>
<td>60</td>
<td>2020-01-01 10:00:00</td>
</tr>
<tr>
<td>2</td>
<td>9002</td>
<td>SQL</td>
<td>easy</td>
<td>60</td>
<td>2020-02-01 10:00:00</td>
</tr>
<tr>
<td>3</td>
<td>9003</td>
<td>算法</td>
<td>medium</td>
<td>80</td>
<td>2020-08-02 10:00:00</td>
</tr>
</tbody>
</table>
<p>请统计2021年每个未完成试卷作答数大于1的有效用户的数据（有效用户指完成试卷作答数至少为1且未完成数小于5），输出用户ID、未完成试卷作答数、完成试卷作答数、作答过的试卷tag集合，按未完成试卷数量由多到少排序。示例数据的输出结果如下：</p>
<table>
<thead>
<tr>
<th>uid</th>
<th>incomplete_cnt</th>
<th>complete_cnt</th>
<th>detail</th>
</tr>
</thead>
<tbody>
<tr>
<td>1002</td>
<td>2</td>
<td>4</td>
<td>2021-09-01:算法;2021-07-02:SQL;2021-09-02:SQL;2021-09-05:SQL;2021-07-05:SQL</td>
</tr>
</tbody>
</table>
<p>解释：2021年的作答记录中，除了1004，其他用户均满足有效用户定义，但只有1002未完成试卷数大于1，因此只输出1002，detail中是1002作答过的试卷{日期:tag}集合，日期和tag间用:连接，多元素间用;连接。</p>
<p>分析：</p>
<ol>
<li>未完成试卷作答数<strong>大于1</strong>—incomplete_cnt &gt; 1</li>
<li>有效用户指完成试卷作答数至少为1<strong>且</strong>未完成数小于5—complete_cnt &gt;= 1—incomplete_cnt &lt; 5</li>
<li>作答过的试卷tag集合—group_concat(distinct concat_ws(‘:’, date(start_time), tag) SEPARATOR ‘;’)</li>
<li>按未完成试卷数量<strong>由多到少</strong>排序—order by incomplete_cnt DESC</li>
</ol>
<pre><code class="mysql">select
  uid,
  count(incomplete) as incomplete_cnt,
  count(complete) as complete_cnt,
  group_concat(
    distinct concat_ws(&#39;:&#39;, date(start_time), tag) SEPARATOR &#39;;&#39;
  ) as detail
from
  (
    select
      uid,
      tag,
      start_time,
      if(submit_time is null, 1, null) as incomplete,
      if(submit_time is null, null, 1) as complete
    from
      exam_record
      left join examination_info using(exam_id)
    where
      year(start_time) = 2021
  ) as exam_complete_rec
group by
  uid
having
  complete_cnt &gt;= 1
  and incomplete_cnt between 2 and 4
order by
  incomplete_cnt desc
</code></pre>
<p>注意：</p>
<p><strong>group_concat（xxx）函数的使用</strong></p>
<ul>
<li>是将分组中括号里对应的字符串进行连接.如果分组中括号里的参数xxx有多行，那么就会将这多行的字符串连接，每个字符串之间会有特定的符号进行分隔。</li>
</ul>
<h3 id="22-题目："><a href="#22-题目：" class="headerlink" title="22.题目："></a>22.题目：</h3><p>现有试卷作答记录表exam_record（uid：用户ID, exam_id：试卷ID, start_time：开始作答时间, submit_time：交卷时间，没提交的话为NULL, score：得分），示例数据如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>uid</th>
<th>exam_id</th>
<th>start_time</th>
<th>submit_time</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1001</td>
<td>9001</td>
<td>2021-07-02 09:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>2</td>
<td>1002</td>
<td>9003</td>
<td>2021-09-01 12:01:01</td>
<td>2021-09-01 12:21:01</td>
<td>60</td>
</tr>
<tr>
<td>3</td>
<td>1002</td>
<td>9002</td>
<td>2021-09-02 12:01:01</td>
<td>2021-09-02 12:31:01</td>
<td>70</td>
</tr>
<tr>
<td>4</td>
<td>1002</td>
<td>9001</td>
<td>2021-09-05 19:01:01</td>
<td>2021-09-05 19:40:01</td>
<td>81</td>
</tr>
<tr>
<td>5</td>
<td>1002</td>
<td>9002</td>
<td>2021-07-06 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>6</td>
<td>1003</td>
<td>9003</td>
<td>2021-09-07 10:01:01</td>
<td>2021-09-07 10:31:01</td>
<td>86</td>
</tr>
<tr>
<td>7</td>
<td>1003</td>
<td>9003</td>
<td>2021-09-08 12:01:01</td>
<td>2021-09-08 12:11:01</td>
<td>40</td>
</tr>
<tr>
<td>8</td>
<td>1003</td>
<td>9001</td>
<td>2021-09-08 13:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>9</td>
<td>1003</td>
<td>9002</td>
<td>2021-09-08 14:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>10</td>
<td>1003</td>
<td>9003</td>
<td>2021-09-08 15:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>11</td>
<td>1005</td>
<td>9001</td>
<td>2021-09-01 12:01:01</td>
<td>2021-09-01 12:31:01</td>
<td>88</td>
</tr>
<tr>
<td>12</td>
<td>1005</td>
<td>9002</td>
<td>2021-09-01 12:01:01</td>
<td>2021-09-01 12:31:01</td>
<td>88</td>
</tr>
<tr>
<td>13</td>
<td>1005</td>
<td>9002</td>
<td>2021-09-02 12:11:01</td>
<td>2021-09-02 12:31:01</td>
<td>89</td>
</tr>
</tbody>
</table>
<p>试卷信息表examination_info（exam_id：试卷ID, tag：试卷类别, difficulty：试卷难度, duration：考试时长, release_time：发布时间），示例数据如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>exam_id</th>
<th>tag</th>
<th>difficulty</th>
<th>duration</th>
<th>release_time</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>9001</td>
<td>SQL</td>
<td>hard</td>
<td>60</td>
<td>2020-01-01 10:00:00</td>
</tr>
<tr>
<td>2</td>
<td>9002</td>
<td>C++</td>
<td>easy</td>
<td>60</td>
<td>2020-02-01 10:00:00</td>
</tr>
<tr>
<td>3</td>
<td>9003</td>
<td>算法</td>
<td>medium</td>
<td>80</td>
<td>2020-08-02 10:00:00</td>
</tr>
</tbody>
</table>
<p>请从表中统计出 “当月均完成试卷数”不小于3的用户们爱作答的类别及作答次数，按次数降序输出，示例输出如下：</p>
<table>
<thead>
<tr>
<th>tag</th>
<th>tag_cnt</th>
</tr>
</thead>
<tbody>
<tr>
<td>C++</td>
<td>4</td>
</tr>
<tr>
<td>SQL</td>
<td>2</td>
</tr>
<tr>
<td>算法</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>解释：用户1002和1005在2021年09月的完成试卷数目均为3，其他用户均小于3；然后用户1002和1005作答过的试卷tag分布结果按作答次数降序排序依次为C++、SQL、算法。</p>
<p>分析：</p>
<ol>
<li>“当月均完成试卷数”不小于3—count(exam_id) / count(distinct DATE_FORMAT(submit_time, “%Y%m”)) &gt;= 3</li>
</ol>
<pre><code class="mysql">select
  tag,
  count(tag) as tag_cnt
from
  exam_record
  join examination_info using(exam_id)
where
  uid in (
    select
      uid
    from
      exam_record
    where
      submit_time is not null
    group by
      uid
    having
      count(exam_id) / count(distinct DATE_FORMAT(start_time, &quot;%Y%m&quot;)) &gt;= 3
  )
group by
  tag
order by
  tag_cnt desc
</code></pre>
<h3 id="23-题目："><a href="#23-题目：" class="headerlink" title="23.题目："></a>23.题目：</h3><p>现有用户信息表user_info（uid用户ID，nick_name昵称, achievement成就值, level等级, job职业方向, register_time注册时间），示例数据如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>uid</th>
<th>nick_name</th>
<th>achievement</th>
<th>level</th>
<th>job</th>
<th>register_time</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1001</td>
<td>牛客1号</td>
<td>3100</td>
<td>7</td>
<td>算法</td>
<td>2020-01-01 10:00:00</td>
</tr>
<tr>
<td>2</td>
<td>1002</td>
<td>牛客2号</td>
<td>2100</td>
<td>6</td>
<td>算法</td>
<td>2020-01-01 10:00:00</td>
</tr>
<tr>
<td>3</td>
<td>1003</td>
<td>牛客3号</td>
<td>1500</td>
<td>5</td>
<td>算法</td>
<td>2020-01-01 10:00:00</td>
</tr>
<tr>
<td>4</td>
<td>1004</td>
<td>牛客4号</td>
<td>1100</td>
<td>4</td>
<td>算法</td>
<td>2020-01-01 10:00:00</td>
</tr>
<tr>
<td>5</td>
<td>1005</td>
<td>牛客5号</td>
<td>1600</td>
<td>6</td>
<td>C++</td>
<td>2020-01-01 10:00:00</td>
</tr>
<tr>
<td>6</td>
<td>1006</td>
<td>牛客6号</td>
<td>3000</td>
<td>6</td>
<td>C++</td>
<td>2020-01-01 10:00:00</td>
</tr>
</tbody>
</table>
<p><em>释义：用户1001昵称为牛客1号，成就值为3100，用户等级是7级，职业方向为算法，注册时间2020-01-01 10:00:00</em></p>
<p>试卷信息表examination_info（exam_id试卷ID, tag试卷类别, difficulty试卷难度, duration考试时长, release_time发布时间） 示例数据如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>exam_id</th>
<th>tag</th>
<th>difficulty</th>
<th>duration</th>
<th>release_time</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>9001</td>
<td>SQL</td>
<td>hard</td>
<td>60</td>
<td>2021-09-01 06:00:00</td>
</tr>
<tr>
<td>2</td>
<td>9002</td>
<td>C++</td>
<td>easy</td>
<td>60</td>
<td>2020-02-01 10:00:00</td>
</tr>
<tr>
<td>3</td>
<td>9003</td>
<td>算法</td>
<td>medium</td>
<td>80</td>
<td>2020-08-02 10:00:00</td>
</tr>
</tbody>
</table>
<p>试卷作答记录表exam_record（uid用户ID, exam_id试卷ID, start_time开始作答时间, submit_time交卷时间, score得分） 示例数据如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>uid</th>
<th>exam_id</th>
<th>start_time</th>
<th>submit_time</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1001</td>
<td>9001</td>
<td>2021-09-01 09:01:01</td>
<td>2021-09-01 09:41:01</td>
<td>70</td>
</tr>
<tr>
<td>2</td>
<td>1002</td>
<td>9003</td>
<td>2021-09-01 12:01:01</td>
<td>2021-09-01 12:21:01</td>
<td>60</td>
</tr>
<tr>
<td>3</td>
<td>1002</td>
<td>9002</td>
<td>2021-09-02 12:01:01</td>
<td>2021-09-02 12:31:01</td>
<td>70</td>
</tr>
<tr>
<td>4</td>
<td>1002</td>
<td>9001</td>
<td>2021-09-01 19:01:01</td>
<td>2021-09-01 19:40:01</td>
<td>80</td>
</tr>
<tr>
<td>5</td>
<td>1002</td>
<td>9003</td>
<td>2021-08-01 12:01:01</td>
<td>2021-08-01 12:21:01</td>
<td>60</td>
</tr>
<tr>
<td>6</td>
<td>1002</td>
<td>9002</td>
<td>2021-08-02 12:01:01</td>
<td>2021-08-02 12:31:01</td>
<td>70</td>
</tr>
<tr>
<td>7</td>
<td>1002</td>
<td>9001</td>
<td>2021-09-01 19:01:01</td>
<td>2021-09-01 19:40:01</td>
<td>85</td>
</tr>
<tr>
<td>8</td>
<td>1002</td>
<td>9002</td>
<td>2021-07-06 12:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>9</td>
<td>1003</td>
<td>9002</td>
<td>2021-09-07 10:01:01</td>
<td>2021-09-07 10:31:01</td>
<td>86</td>
</tr>
<tr>
<td>10</td>
<td>1003</td>
<td>9003</td>
<td>2021-09-08 12:01:01</td>
<td>2021-09-08 12:11:01</td>
<td>40</td>
</tr>
<tr>
<td>11</td>
<td>1003</td>
<td>9003</td>
<td>2021-09-01 13:01:01</td>
<td>2021-09-01 13:41:01</td>
<td>70</td>
</tr>
<tr>
<td>12</td>
<td>1003</td>
<td>9001</td>
<td>2021-09-08 14:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>13</td>
<td>1003</td>
<td>9002</td>
<td>2021-09-08 15:01:01</td>
<td>(NULL)</td>
<td>(NULL)</td>
</tr>
<tr>
<td>14</td>
<td>1005</td>
<td>9001</td>
<td>2021-09-01 12:01:01</td>
<td>2021-09-01 12:31:01</td>
<td>90</td>
</tr>
<tr>
<td>15</td>
<td>1005</td>
<td>9002</td>
<td>2021-09-01 12:01:01</td>
<td>2021-09-01 12:31:01</td>
<td>88</td>
</tr>
<tr>
<td>16</td>
<td>1005</td>
<td>9002</td>
<td>2021-09-02 12:11:01</td>
<td>2021-09-02 12:31:01</td>
<td>89</td>
</tr>
</tbody>
</table>
<p>请计算每张类别试卷发布后，当天5级以上的用户作答的人数uv和平均分avg_score，按人数降序，相同人数的按平均分升序，示例数据结果输出如下：</p>
<table>
<thead>
<tr>
<th>exam_id</th>
<th>uv</th>
<th>avg_score</th>
</tr>
</thead>
<tbody>
<tr>
<td>9001</td>
<td>3</td>
<td>81.3</td>
</tr>
</tbody>
</table>
<p>解释：只有一张SQL类别的试卷，试卷ID为9001，发布当天（2021-09-01）有1001、1002、1003、1005作答过，但是1003是5级用户，其他3位为5级以上，他们三的得分有[70,80,85,90]，平均分为81.3（保留1位小数）。</p>
<p>分析：</p>
<ol>
<li>当天5级以上的用户作答的人数</li>
<li>平均分avg_score—round(avg(temp_table.score), 1) as avg_score</li>
<li>按人数降序，按平均分升序—order by uv desc, avg_score asc</li>
</ol>
<pre><code class="mysql">select
  temp_table.exam_id as exam_id,
  count(distinct temp_table.uid) as uv,
  round(avg(temp_table.score), 1) as avg_score
from
  (
    select
      uid,
      exam_id,
      score
    from
      exam_record as er
      left join examination_info as ei using(exam_id)
    where
      er.submit_time is not null
      and date_format(ei.release_time, &#39;%Y%m&#39;) = date_format(er.submit_time, &#39;%Y%m&#39;)
  ) as temp_table
where
  temp_table.uid in (
    select
      ui.uid
    from
      user_info as ui
    where
      ui.level &gt; 5
  )
group by
  temp_table.exam_id
order by
  uv desc,
  avg_score asc;
</code></pre>
<h2 id="思考一下："><a href="#思考一下：" class="headerlink" title="思考一下："></a>思考一下：</h2><ol>
<li>确定主表（数据的主要获取源</li>
<li>确定辅助表（可能用于子查询</li>
<li>描述中出现“每”，带有each意味的词，一般要使用group by</li>
</ol>

        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="alipay-code"><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/AliPayQR.png"></li>
                <li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/WeChanQR.png"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
      <!--     <div class="post-tags">
					<div class="tag-cloud">
                  <div class="tag-cloud-title">
                  </div>
                  <div class="tag-cloud-tags">
                  <a href="/tags/Spring/" style="font-size: 10px; color: #f38181">Spring</a> <a href="/tags/ajax/" style="font-size: 10px; color: #f38181">ajax</a> <a href="/tags/css/" style="font-size: 12.5px; color: #dc9996">css</a> <a href="/tags/js/" style="font-size: 15px; color: #c4b1aa">js</a> <a href="/tags/nodeJs/" style="font-size: 10px; color: #f38181">nodeJs</a> <a href="/tags/spring/" style="font-size: 10px; color: #f38181">spring</a> <a href="/tags/sql/" style="font-size: 10px; color: #f38181">sql</a> <a href="/tags/uni-app/" style="font-size: 10px; color: #f38181">uni-app</a> <a href="/tags/vue/" style="font-size: 10px; color: #f38181">vue</a> <a href="/tags/吐槽/" style="font-size: 12.5px; color: #dc9996">吐槽</a> <a href="/tags/大学所学/" style="font-size: 17.5px; color: #adc9bf">大学所学</a> <a href="/tags/机器学习/" style="font-size: 10px; color: #f38181">机器学习</a> <a href="/tags/算法/" style="font-size: 20px; color: #95e1d3">算法</a> <a href="/tags/设计模式/" style="font-size: 10px; color: #f38181">设计模式</a>
                  </div>
                </div>

          </div> -->
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
          
            <div class="post-nepre half previous">
          
            <a href="/undefined/实（学）习日记/" rel="prev">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/kitholt/cdn/cdn/img/nervous.jpg" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/kitholt/cdn/cdn/img/nervous.jpg">
              </div>
              <span class="label">
              Previous Post</span>
              <div class="info">
                <h3>
                实（学）习日记</h3>
                <hr>
              </div>
            </a>
          </div>
        
        
          
            <div class="post-nepre half next">
          
            <a href="/undefined/JS算法之脑洞大开-freeCodeCamp/" rel="next">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/brokenHeart.jpg" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/brokenHeart.jpg">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                JS算法之脑洞大开---freeCodeCamp</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      
<div id="vcomments"></div>
<script>
  window.onload = function(){
      var valine = new Valine();
      valine.init({
        el: '#vcomments',
        appId: "vK4njxg3C8GQOr9L6M8Hav7x-gzGzoHsz",
        appKey: "e9eG1y4IcG54g4l676M1xeWQ",
        path: window.location.pathname,
        placeholder: "整点留言呗"
      })
  }
</script>

      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="https://schema.org/Person">
          <a href="" class="profile gravatar"><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt3.jpeg" itemprop="image" alt="" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="" itemprop="url" rel="author"></a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i></p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            // PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- <footer id="footer">
  

  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Kitholt Frank<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #666666;">&copy 2021</p>
    </div>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #b9b9b9;">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Sakura</a> <i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> by <a href="https://2heng.xin/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Mashiro</a>&<a href="https://www.hojun.cn/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Hojun</a>, Powered by Hexo, Hosted by Coding Pages</a>
        </span>
      </p>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_uv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人</span>
    </div>
  </div><!-- .site-info -->
    
</footer>







<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>
<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
</script>

    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt3.jpeg">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">KitholtFrank</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="http://github.com/kitholt" class="fa fa-github" target="_blank" style="color: #333; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/categories/技术/">
                  <i class="fa fa-code" aria-hidden="true"></i>
                  技术
                </a>
              </li>
            
              <li>
                <a href="/categories/生活/">
                  <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  生活
                </a>
              </li>
            
              <li>
                <a href="/categories/资源/">
                  <i class="fa fa-cloud-download" aria-hidden="true"></i>
                  资源
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="javascript:;">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
            清单
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/music/">
                  <i class="fa fa-headphones" aria-hidden="true"></i>
                  歌单
                </a>
              </li>
            
              <li>
                <a href="/bangumi/">
                  <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                  番组
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/comment/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
            留言板
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/donate/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
            资瓷
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            关于
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/about/">
                  <i class="fa fa-meetup" aria-hidden="true"></i>
                  我？
                </a>
              </li>
            
          </ul>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2019 hexo-sakura</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<!-- require MetingJS -->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #FF1493;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<meting-js

    id="890672374"

    server="netease"

    type="playlist"

    fixed="true"

    autoplay="false"

    loop="all"

    order="random"

    preload="auto"

    volume="0.7"

    mutex="true"

</meting-js>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
<noscript><iframe src="/blog/*>";</iframe></noscript>
<script src="https://cdn.jsdelivr.net/gh/Sanarous/files@1.151/js/click.min.js"></script>


<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/piao.js"></script>
 
<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/canvas-nest.min.js"></script>

<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/clickBom.js"></script>


</html>