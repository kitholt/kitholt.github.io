<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">蛋疼のNode学习之路(持续更新...) | 欢迎来到Franの杂货铺</title>
  
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "KItholtFrank";
  mashiro_option.author_name = "Frank";
  mashiro_option.site_url = "https://kitholt.github.io/";
  mashiro_option.v_appId = "vK4njxg3C8GQOr9L6M8Hav7x-gzGzoHsz";
  mashiro_option.v_appKey = "e9eG1y4IcG54g4l676M1xeWQ";
  mashiro_option.mathjax = "0";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
  var bg = "https://cdn.jsdelivr.net/gh/kitholt/cdn/img/warriors.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/best.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/curry.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/chase.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/stadium.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/splashbros.webp,https://cdn.jsdelivr.net/gh/kitholt/cdn/img/coolkt.webp,".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配哦~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}
  </style>
</head>
</html>
<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop filter-dim">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="https://kitholt.github.io/">
          <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt3.jpeg">
        </a>
      </div>
      <div class="header-info">
        <p>你来啦!欢迎来到Franの杂货铺！</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="http://github.com/kitholt" target="_blank" class="social-github" title="github">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialgithub.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://weibo.com/u/7188904314" target="_blank" class="social-github" title="sina">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialsina.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://music.163.com/#/my/m/music/playlist?id=890672374" target="_blank" class="social-github" title="wangyiyun">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialwangyiyun.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://www.zhihu.com/people/frank-41-24-53" target="_blank" class="social-github" title="zhihu">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialzhihu.png">
                  </a>
                </li>
              
            
              
                <li class="wechat">
                  <a href="/#">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialwechat.png">
                  </a>
                  <div class="wechatInner">
                    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/socialQR.jpg">
                  </div>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono">KItholt</span>
            <span class="shironeko">Frank</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/categories/技术/">
                          <i class="fa fa-code" aria-hidden="true"></i>
                          技术
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/生活/">
                          <i class="fa fa-file-text-o" aria-hidden="true"></i>
                          生活
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/资源/">
                          <i class="fa fa-cloud-download" aria-hidden="true"></i>
                          资源
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="javascript:;">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
                    清单
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/music/">
                          <i class="fa fa-headphones" aria-hidden="true"></i>
                          歌单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/bangumi/">
                          <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                          番组
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/comment/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
                    留言板
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/donate/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
                    资瓷
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    关于
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/about/">
                          <i class="fa fa-meetup" aria-hidden="true"></i>
                          我？
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

  <div class="pattern-center single-center">
    <!-- 有配图默认渲染第一张 -->
    <div class="pattern-attachment-img lazyload" style="background-image: url(https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt2.jpeg);" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt2.jpeg">
    </div>
    <header class="pattern-header single-header">
      <h1 class="entry-title">
      蛋疼のNode学习之路(持续更新...)</h1>
      <p class="entry-census">
        <span>
          <a href="">
            <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt3.jpeg">
          </a>
        </span>
        <span>
          <a href=""></a>
        </span>
        <span class="bull">
        ·</span>
        2021-3-3<span class="bull">
        ·</span>
      <span id="busuanzi_value_page_pv"></span>次阅读</p>
    </header>
  </div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
        <div class="entry-content">
          <h1 id="蛋疼のNode学习之路（持续更新…）"><a href="#蛋疼のNode学习之路（持续更新…）" class="headerlink" title="蛋疼のNode学习之路（持续更新…）"></a>蛋疼のNode学习之路（持续更新…）</h1><h1 id="Day1"><a href="#Day1" class="headerlink" title="Day1"></a>Day1</h1><p><span style="color:green; font-size:30px;font-family:fantasy">Previously on ‘Preface’</span>，对于一个<strong>几乎</strong>零基础的我来说，搭建博客的过程是十分<span style="font-size:35px;color:red"><strong>痛苦</strong></span>的，这现在只是一个简单的修改博客主题和编辑的过程啊（<span style="color:blue;font-size:25px">前端知识盲区</span>o(╥﹏╥)o）。所以我决定花上一定时间来学习<em>Node.js</em>。希望学完之后我能<strong>更好的</strong>运维我的BLog（顺便复【yu】习一下Web相关知识，HTML5，CSS3，JavaScript什么的都快忘光光啦）话不多说，今天开始第一天的学习！</p>
<h2 id="①那么，Node-js是乜嘢？（what？）"><a href="#①那么，Node-js是乜嘢？（what？）" class="headerlink" title="①那么，Node.js是乜嘢？（what？）"></a>①那么，Node.js是乜嘢？（what？）</h2><h3 id="解释："><a href="#解释：" class="headerlink" title="解释："></a>解释：</h3><ul>
<li>不是一门语言，不是库，不是框架。而是一个js的<span style="color:red"><strong><em>运行时</em></strong></span> ，通俗地说就是能够一个能够运行js的平台环境。</li>
</ul>
<ul>
<li>可提供服务器级别的api（需要引入相关的模块，比如文件读写需要’fs’，也就是File-System）：文件读写，网络服务构建，网络通信，http服务器（http模块）……//后面会讲模块系统</li>
</ul>
<h3 id="特性："><a href="#特性：" class="headerlink" title="特性："></a>特性：</h3><ol>
<li>事件驱动</li>
<li>非阻塞IO模型（异步）————————————-<span style="color:grey;font-size:25px">啊啥是同步和异步？，又要去恶补了o((⊙﹏⊙))o</span></li>
<li>轻量和高效</li>
</ol>
<h3 id="与Node-js相关的东东"><a href="#与Node-js相关的东东" class="headerlink" title="与Node.js相关的东东"></a>与Node.js相关的东东</h3><p>npm：全称是Node Package Manager。世界上最大的开源生态系统（大多数的js相关的包都在npm里）可在命令行通过下列语法获取相关包</p>
<pre><code>npm install [jquery]
</code></pre><h2 id="②Node-js能干啥哇？（do-what？）"><a href="#②Node-js能干啥哇？（do-what？）" class="headerlink" title="②Node.js能干啥哇？（do what？）"></a>②Node.js能干啥哇？（do what？）</h2><ul>
<li><p>web服务器后台（能干类似活的有Java,，PHP，Python，balabala…….）</p>
</li>
<li><p>命令行工具</p>
<ul>
<li>npm</li>
<li>git</li>
<li>hexo （这个我熟哈哈）</li>
</ul>
</li>
</ul>
<h2 id="③参考资源（resource）"><a href="#③参考资源（resource）" class="headerlink" title="③参考资源（resource）"></a>③参考资源（resource）</h2><ul>
<li>《深入浅出Node.js》（偏理论）</li>
<li>《Node.js权威指南》</li>
<li>JavaScript标准参考教程（alpha）作者：阮一峰（惊了，英文名也叫Frank）</li>
<li>Node入门（fen）</li>
<li>cNode社区</li>
</ul>
<h2 id="④安装Node（install）"><a href="#④安装Node（install）" class="headerlink" title="④安装Node（install）"></a>④安装Node（install）</h2><p>会的都会，不会的戳一戳下面的教程：</p>
<p><strong>参考教程：<a href="https://www.runoob.com/nodejs/nodejs-install-setup.html" target="_blank" rel="noopener">https://www.runoob.com/nodejs/nodejs-install-setup.html</a></strong></p>
<h2 id="⑤模块系统（Module-system）"><a href="#⑤模块系统（Module-system）" class="headerlink" title="⑤模块系统（Module system）"></a>⑤模块系统（Module system）</h2><ol>
<li>在Node中，每一个<strong><em>js文件</em></strong>都是一个模块，另外Node中也没有全局作用域的概念。</li>
<li>在Node中，只能通过require()方法加载js文件。</li>
<li><p>require()方法只加载其中的代码。既然没有全局作用域，那么各个js文件之间是模块作用域。 </p>
<ul>
<li>模块全封闭。</li>
<li>外部和内部之间是无法互相访问的。</li>
</ul>
</li>
<li><p>其实每个模块中有都一个exports专属的对象，该对象中可以封装各自模块中的数据和方法，方便其他模块应用</p>
<ul>
<li><p>举个例子</p>
<pre><code class="javascript">var demo =require(&#39;./a&#39;)//调用模板a，并且获得a的exports对象,并且用一个变量demo接收
</code></pre>
</li>
</ul>
</li>
</ol>
<h2 id="——————-分割线，下面进入简单的实操环节——————–"><a href="#——————-分割线，下面进入简单的实操环节——————–" class="headerlink" title="——————-分割线，下面进入简单的实操环节——————–"></a>——————-分割线，下面进入简单的实操环节——————–</h2><ol>
<li><p>启动一个简单服务器</p>
<pre><code class="javascript">var http = require(&#39;http&#39;)//创建http对象
var server = http.createServer()//利用http对象创建一个服务器对象server
server.listen(4000, function () {//选择端口
   console.log(&quot;贪玩蓝月服务器，琦动！&quot;)
})
server.on(&#39;request&#39;, function (request, response) {//server监听是否收到客户端发送过来的request，收到后根据回调函数再返回响应
   console.log(&quot;收到请求&quot;)
   response.writeHeader(200, {&#39;Content-Type&#39;: &#39;text/html;charset=utf-8&#39;})//&lt;-----------解决乱码的方法
   var url = request.url
   if (url == &#39;/&#39;) {
       response.end(&quot;欢迎来到贪玩蓝月，是兄弟就来砍我&quot;)
   }
   else if(url==&#39;/login&#39;){
       response.end(&quot;貪玩藍月登錄註冊界面...&quot;)
   }
   else if(url==&#39;/register&#39;){
       response.end(&quot;快進到貪玩藍月の註冊界面&quot;)
   }
   else{
       response.end(&quot;404 not found...&quot;)
   }

})
</code></pre>
<p>但是第一次运行的时候出现这种情况…….</p>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/error.png" alt="第一反应：响应头没有设置utf-8编码"></p>
</li>
</ol>
<p>不用慌，在回调函数里的第一行加上</p>
<pre><code class="javascript">response.writeHeader(200, {&#39;Content-Type&#39;: &#39;text/html;charset=utf-8&#39;})
</code></pre>
<hr>
<p>运行后的截图</p>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/fixed.png" alt></p>
<p>当然一个网站肯定不能只是傻傻地响应同一段内容，服务器必须根据浏览器(客户端)发来的请求信息来对应地响应合适的内容。</p>
<p>实现方法也特别简单，加入一组if-else的判断就可。（详情见上代码line10-21）</p>
<p>实现效果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/register.png" alt></p>
<p>And:</p>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/error404.png" alt></p>
<p>2.模块系统</p>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/module_demo.png" alt></p>
<p>解释：在demo中引入模板a—&gt;执行a的代码，在控制台打印starting语句—&gt;引入模板b—&gt;打印模板b的opening和closed—&gt;a中的引用结束，打印a的end—&gt;打印从a模板获取的值foo=200</p>
<p>从中我们发现输出的foo值是模板a中的，而不是b模板中的。这也体现了模块作用域的好处：<span style="color:red;font-family:隶书;font-size:30px">可以加载执行多个文件，可以完全避免变量命名而产生的冲突</span>（认真脸）</p>
<hr>
<h2 id="⑥相关知识补充"><a href="#⑥相关知识补充" class="headerlink" title="⑥相关知识补充"></a>⑥相关知识补充</h2><ol>
<li><p>同步（Synchronous）</p>
<p>A程序调用B程序，必须等待B程序完成才能返回到A程序，A程序继续执行……从流程上看是一条”直线“</p>
</li>
<li><p>异步（Asynchronous）</p>
<p>A程序调用B程序，此时A不会等待B程序是否执行完毕，而是继续往后执行自己的代码……从流程上看是出现了一条从主线产生的“支线”</p>
</li>
<li><p>回调函数</p>
<p><strong><u>A callback is a function that is passed as an argument to another function and is executed after its parent function has completed.</u></strong>（来自谷歌的解释）</p>
<p>通俗讲就是</p>
<p>①你到一个商店买东西，刚好你要的东西没有货，于是你在店员那里留下了你的电话，过了几天店里有货了，店员就打了你的电话，然后你接到电话后就到店里去取了货。在这个例子里，你的电话号码就叫回调函数，你把电话留给店员就叫登记回调函数，店里后来有货了叫做触发了回调关联的事件，店员给你打电话叫做调用回调函数，你到店里去取货叫做响应回调事件。回答完毕。</p>
<p><del>什么还不懂？</del>行，还有个例子：<del>②约会结束后你送你女朋友回家，离别时，你肯定会说：“到家了给我发条信息，我很担心你。” 对不，然后你女朋友回家以后还真给你发了条信息。小伙子，你有戏了。其实这就是一个回调的过程。你留了个参数函数（要求女朋友给你发条信息）给你女朋友，然后你女朋友回家，回家的动作是主函数。她必须先回到家以后，主函数执行完了，再执行传进去的函数，然后你就收到一条信息了。</del>~（单身的看例子①就好了）</p>
</li>
</ol>
<h1 id="Day2"><a href="#Day2" class="headerlink" title="Day2"></a>Day2</h1><p>   今天主要围绕模板引擎的概念以及应用方式、渲染这两点展开，并且相对应地结合两个小案例来更进一步的理解感受它们。话不多少，先介绍主要概念。</p>
<h2 id="神么是模板引擎？"><a href="#神么是模板引擎？" class="headerlink" title="神么是模板引擎？"></a>神么是模板引擎？</h2><p>   模板引擎（这里特指用于Web开发的模板引擎）是为了使用户界面与业务数据（内容）分离而产生的，它可以生成特定格式的文档，用于网站的模板引擎就会生成一个标准的HTML文档。这就好比于我们的写作模板，我们想写什么类型的文章比如说明文，记叙文，抒情文，应用文。它们都有固定的一套模式，我们只要按照这套模式来，往里面添加我们自己的内容即可。</p>
<p>   常用模板：art-template（art-template 是一个简约、超快的模板引擎。<br>   它采用作用域预声明的技术来优化模板渲染速度，从而获得接近 JavaScript 极限的运行性能，并且同时支持 NodeJS 和浏览器。）</p>
<p>   安装方法：</p>
<pre><code class="控制台">npm install art-template --save
</code></pre>
<h2 id="啥是渲染？"><a href="#啥是渲染？" class="headerlink" title="啥是渲染？"></a>啥是渲染？</h2><p>在电脑绘图中，<em>渲染</em>是指在指用软件从模型生成图像的过程。而在HTML中则是指如何加工并且显示出最终的HTML页面。我们又根据加工场景位置的不同把HTML渲染分为服务端渲染和客户端渲染。</p>
<p> 互联网早期，用户使用浏览器浏览的都是一些没有复杂逻辑的、简单的页面，这些页面都是在后端将html拼接好的然后将之返回给前端完整的html文件，浏览器拿到这个html文件之后就可以直接解析展示了，而这也就是所谓的<strong>服务器端渲染</strong>了。而随着前端页面的复杂性提高，前端就不仅仅是普通的页面展示了，而可能添加了更多功能性的组件，复杂性更大，另外，彼时<strong>ajax的兴起</strong>，使得业界就开始推崇<strong>前后端分离</strong>的开发模式，即后端不提供完整的html页面，而是提供一些api使得前端可以获取到json数据，然后前端拿到json数据之后再在前端进行html页面的拼接，然后展示在浏览器上，这就是所谓的<strong>客户端渲染</strong>了，这样前端就可以专注UI的开发，后端专注于逻辑的开发。</p>
<h3 id="服务端渲染aka后端渲染（service-side-render）の优缺点："><a href="#服务端渲染aka后端渲染（service-side-render）の优缺点：" class="headerlink" title="服务端渲染aka后端渲染（service-side render）の优缺点："></a>服务端渲染aka后端渲染（service-side render）の优缺点：</h3><ul>
<li>优点</li>
</ul>
<ol>
<li>减轻前端压力</li>
<li>不用占用前端的资源，比如在用手机浏览网页时，浏览器的负担减轻，因此能够节省手机的电量</li>
<li>有利于SEO（Search Engine Optimization）搜索引擎优化。爬虫能够爬取到在后端的HTML文档</li>
</ol>
<ul>
<li>缺点</li>
</ul>
<ol>
<li><strong>不利于前后端分离，开发效率低。</strong>使用服务器端渲染，则无法进行分工合作，则对于前端复杂度高的项目，不利于项目高效开发。另外，如果是服务器端渲染，则<strong>前端一般就是写一个静态html文件</strong>，然后<strong>后端再修改为模板</strong>，这样是非常低效的，并且还常常需要前后端共同完成修改的动作； <strong>或者是前端直接完成html模板，然后交由后端</strong>。另外，如果后端改了模板，前端还需要根据改动的模板再调节css，这样使得前后端联调的时间增加。</li>
<li><strong>占用服务器端资源</strong>。即服务器端完成html模板的解析，如果请求较多，会对服务器造成一定的访问压力。而如果使用前端渲染，就是把这些解析的压力分摊了前端，而这里确实完全交给了一个服务器。</li>
</ol>
<h3 id="客户端渲染aka前端渲染（client-side-render）的优缺点："><a href="#客户端渲染aka前端渲染（client-side-render）的优缺点：" class="headerlink" title="客户端渲染aka前端渲染（client-side render）的优缺点："></a>客户端渲染aka前端渲染（client-side render）的优缺点：</h3><ul>
<li><p>艾达王替矩（advantages）：</p>
<ol>
<li>前后端分离，前端能够自定义UI而不用去过度依赖后端</li>
</ol>
</li>
<li><p>diss艾达王替矩：</p>
<ol>
<li>前端的响应速度会变慢，这就是为什么我们在浏览一些网页时，经常会<em>“爱的魔力转圈圈”</em>。（后端的渲染速度要比前端的快）</li>
<li><strong>不利于SEO</strong>。目前比如百度、谷歌的爬虫对于SPA都是不认的，只是记录了一个页面，所以SEO很差。因为服务器端可能没有保存完整的html，而是前端通过js进行dom的拼接，那么爬虫无法爬取信息。 除非搜索引擎的seo可以增加对于JavaScript的爬取能力，这才能保证seo。</li>
</ol>
</li>
</ul>
<h2 id="小案例一：模拟Apacheの目录HTML（服务端渲染）"><a href="#小案例一：模拟Apacheの目录HTML（服务端渲染）" class="headerlink" title="小案例一：模拟Apacheの目录HTML（服务端渲染）"></a>小案例一：模拟Apacheの目录HTML（服务端渲染）</h2><p>在此之前我们还需要用到fs模块的readFile()和readdir()方法，简单介绍一下这两个方法：</p>
<ul>
<li><p>readFile()：<br>能够读取指定路径下的文件并保存到data中，data是一个二进制的数据流（里面全是010101），因此要将其转变为我们认识的字符串需要用到toString()方法。</p>
</li>
<li><p>readdir()：</p>
<p>读取指定目录下的所有文件夹名，并返回一个由这些文件夹名构成的字符串数组files。</p>
<pre><code class="javascript">var fs = require(&#39;fs&#39;);
fs.readdir(&#39;readdirtest&#39;, function(err,files){
 if(err){
  console.log(err);
 }
 console.log(files);
})
</code></pre>
</li>
</ul>
<p>操作描述：</p>
<ol>
<li><p>加载必要的模块fs，http…</p>
</li>
<li><p>设置端口号xxxx</p>
</li>
<li><p>为服务器设置响应信息</p>
<ul>
<li>读取模板文件template.html（目录显示页），并且将要替换的区域使用特殊符号进行标记，这里我使用了<strong><em><span style="color: blue;font-size:30px">-.-</span></em></strong>这个标记</li>
<li>读取目录列表的所有文件夹</li>
<li>并将要替换的部分用一个变量content表示</li>
<li>用forEach方法依次取出files里的文件夹名并构建content（见代码20—24）</li>
<li>将第一步读取的data转换为字符串</li>
<li><p>简单字符串解析替换操作，将template中替换的区域-.-（特殊标记）用content代替</p>
</li>
<li><p>发送响应</p>
</li>
</ul>
</li>
</ol>
<p>下面是<span style="color:green;font-size:26px">一小段</span>代码：</p>
<pre><code class="javascript">var fs = require(&#39;fs&#39;)
var http = require(&#39;http&#39;)
var server = http.createServer()
var wwwDir = &#39;F:/www&#39;

server.on(&#39;request&#39;, function (req, res) {

    fs.readFile(&#39;./template.html&#39;, function (err, data) {//获得模板template.html
        if (err) {
            console.log(&#39;找不到文件......请重试&#39;)
        }


        fs.readdir(wwwDir, function (err, files) {//得到wwwDir的目录列表中的文件名和目录名
            if (err) {
                return console.log(&#39;读取目录失败&#39;)
            }
            console.log(files)//files是一个字符数组，元素为目录中的文件名
            var content = &#39;&#39;//将模板中要替换的部分构建为content
            files.forEach(function (item) {//利用forEach，取出files数组的每个元素（item），进行渲染${item}替换
                content += `&lt;tr&gt;&lt;td data-value=&quot;新建 Microsoft Word 文档.docx&quot;&gt;&lt;a class=&quot;icon file&quot; draggable=&quot;true&quot; href=&quot;/F:/www/%E6%96%B0%E5%BB%BA%20Microsoft%20Word%20%E6%96%87%E6%A1%A3.docx&quot;&gt;${item}&lt;/a&gt;&lt;/td&gt;
                                &lt;td class=&quot;detailsColumn&quot; data-value=&quot;0&quot;&gt;0 B&lt;/td&gt;
                                &lt;td class=&quot;detailsColumn&quot; data-value=&quot;1612679895&quot;&gt;2021/2/7 下午2:38:15&lt;/td&gt;
                            &lt;/tr&gt;`
            })


            data = data.toString()//将二进制流的data转换为字符串
            data=data.replace(&#39;-.-&#39;, content)//简单字符串解析替换操作，将template中替换的区域-.-（特殊标记）用content代替
            res.end(data)//发送响应数据
        })
    })
})

server.listen(4001, function () {
    console.log(&#39;服务器，琦动！&#39;)
})
</code></pre>
<p>结果截图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/Apache.png" alt></p>
<h2 id="小案例二：art-template"><a href="#小案例二：art-template" class="headerlink" title="小案例二：art-template"></a>小案例二：art-template</h2><p>需要一个用于<strong><em>储存模板的htm</em>l</strong>和一个<strong><em>js文件</em></strong></p>
<p>html模板:</p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;This is Frank&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;p&gt;My name is {{ name }}.&lt;/p&gt;
&lt;p&gt;I am {{ age }} years old.&lt;/p&gt;
&lt;p&gt;I am from {{ province }}.&lt;/p&gt;
&lt;p&gt;I like {{ each hobbies }} {{ $value }} {{/each}}&lt;/p&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
<p>如果没有art-template，运行结果如下：</p>
<p><img src="http://r.photo.store.qq.com/psc?/V53IelwN4WhBA02YDe1a34IokT47iUtd/45NBuzDIW489QBoVep5mcYRGQ6MX9QLt.ZabGPiEYi15Ba0otCJVhzv*bdCntYBvAuXm*D.3zucSdafP*BeQ.C8f*TXyYFvFk9yAYOpFRqM!/r" alt></p>
<p>加了art-template后：</p>
<pre><code class="javascript">var fs=require(&#39;fs&#39;)
var http=require(&#39;http&#39;)
var template=require(&#39;art-template&#39;)
http
    .createServer(function(req,res){
        var url=req.url
        if(url===&#39;/&#39;){
            fs.readFile(&#39;./Frank.html&#39;,function(err,data){
                if(err){
                    return res.end(&#39;你访问的网址不存在噢&#39;)
                }
                data=data.toString()
                var Frank=template.render(data,{
                    name:&#39;Frank&#39;,
                    age:20,
                    province:&#39;ChongQing&#39;,
                    hobbies:[&#39;打篮球&#39;,&#39;写博客&#39;,&#39;吹水&#39;]
                })
                res.end(data)
            })
        }

    })
.listen(3000,function(){
    console.log(&#39;琦动！&#39;)
</code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/aboutFrank.png" alt></p>
<p>由此可见，art-template只关注中的值，不会去关心html中的格式。因此可以理解为<strong><em><span style="color:red;font-size:35px">js数据传到html中展示出来</span></em></strong></p>
<h1 id="Day3"><a href="#Day3" class="headerlink" title="Day3"></a>Day3</h1><h2 id="Node中的模块系统"><a href="#Node中的模块系统" class="headerlink" title="Node中的模块系统"></a>Node中的模块系统</h2><h3 id="模块の定义："><a href="#模块の定义：" class="headerlink" title="模块の定义："></a>模块の定义：</h3><p> node应用由模块组成，采用的commonjs模块规范。每一个文件就是一个模块，拥有自己独立的作用域，变量，以及方法等，对其他的模块都不可见。CommonJS规范规定，每个模块内部，module变量代表当前模块。这个变量是一个对象，它的exports属性（即module.exports）是对外的接口。加载某个模块，其实是加载该模块的module.exports属性。require方法用于加载模块。</p>
<hr>
<p>使用Node编写应用程序主要就是在使用：</p>
<ul>
<li>Ecmascript</li>
<li>核心模块<ul>
<li>文件操作fs</li>
<li>http服务的http</li>
<li>url路径操作的模块</li>
<li>path路径处理模块</li>
<li>os操作系统模块</li>
</ul>
</li>
<li><p>第三方模块</p>
<ul>
<li>art-template</li>
<li>必须通过npm下载</li>
</ul>
</li>
<li><p>开发者自个儿写的模块（自定义的）</p>
</li>
</ul>
<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><ul>
<li><p>文件作用域</p>
</li>
<li><p>通信规则</p>
<ul>
<li>加载require</li>
<li>导出<h3 id="CommonJs模块规范"><a href="#CommonJs模块规范" class="headerlink" title="CommonJs模块规范"></a>CommonJs模块规范</h3></li>
</ul>
</li>
</ul>
<p>这就是要谈论的——模 块 系 统</p>
<ul>
<li>模块作用域</li>
<li>使用require方法用来加载模块</li>
<li>使用exports接口对象来导出模块中的成员</li>
</ul>
<h4 id="加载require"><a href="#加载require" class="headerlink" title="加载require"></a>加载require</h4><p>操作：</p>
<pre><code class="javascript">var 自定义变量名称=require(&#39;模块&#39;)
</code></pre>
<p>两个作用：</p>
<ul>
<li><p>执行被加载模块中的代码</p>
</li>
<li><p>得到被加载模块中的<code>exports</code>导出接口对象</p>
</li>
</ul>
<h4 id="导出exports"><a href="#导出exports" class="headerlink" title="导出exports"></a>导出<code>exports</code></h4><ul>
<li>Node中是模块作用域，默认文件中所有成员只在当前文件模块有效</li>
<li>如果我们想要访问其他模块的成员，可以把这些成员加载到<code>exports</code>上去</li>
</ul>
<p>导出多个成员：</p>
<pre><code class="javascript">exports.demo=foo
exports.test=&#39;233&#39;
exports.fun=function(){
    xxxxxxxxxxxxx
}
</code></pre>
<p>也可以这样导出多个成员：</p>
<pre><code class="javascript">module.exports={
    add: function(){
    return xxxxxxx
    },
    foo:&#39;123&#39;
}
</code></pre>
<p>导出单个成员（指定的）：</p>
<pre><code class="javascript">module.exports=&#39;666&#39;
module.exports=function(){

}
</code></pre>
<p>注意：<strong>在使用module.exports时，后一个的会覆盖前一个的module.exports</strong></p>
<h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>在底层代码中：<strong><span style="color:red;font-size:35px">exports是module.exports的一个引用—&gt;exports=module.exports</span></strong></p>
<pre><code class="javascript">console.log(exports===module.exports)//会返回true
exports.foo=&#39;666&#39;
module.exports.foo=&#39;666&#39;//等价
</code></pre>
<h3 id="require方法加载规则"><a href="#require方法加载规则" class="headerlink" title="require方法加载规则"></a>require方法加载规则</h3><ul>
<li><p>核心模块</p>
<ul>
<li>模块名</li>
</ul>
</li>
<li><p>第三方模块</p>
<ul>
<li>模块名</li>
</ul>
</li>
<li><p>开发者自己写的</p>
<ul>
<li>路径</li>
</ul>
</li>
<li><p>优先从缓存加载</p>
<ul>
<li>加载过的模块会暂存入缓存中，若下次还有调用，直接从缓存中读取， 能有效提高模块加载效率</li>
</ul>
</li>
</ul>
<h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><p>每一个项目最好有一个包描述文件（package.json，就像产品的说明书）。可通过<code>npm init</code>生成 。有了该文件，再用<code>npm install</code>就能把文件里的依赖项全部下载回来，就相当于原先有了备份，现在进行备份还原</p>
<ol>
<li>在每个项目的根目录下应该有一个package.json文件</li>
<li>每次安装第三方包时，应该在后面加上<code></code>–save`，可以用来保存依赖项信息</li>
</ol>
<h3 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h3><ul>
<li><p>[npm网站]: npmjs.com</p>
</li>
<li><p>命令行工具</p>
</li>
</ul>
<pre><code class="shell">npm install --global npm//更新命令
</code></pre>
<ul>
<li><p>常用命令</p>
<ul>
<li><pre><code class="shell">npm init -y//快速生成package.json文件
</code></pre>
</li>
<li><pre><code class="shell">npm install
</code></pre>
</li>
<li><pre><code>npm install 包名//下载指定包
</code></pre></li>
<li><pre><code class="shell">npm install --save 包名//下载指定包并保存到package.json的dependencies中
</code></pre>
</li>
<li><pre><code class="shell">npm uninstall 包名
</code></pre>
</li>
<li><pre><code class="shell">npm help//查看使用帮助
</code></pre>
</li>
<li><pre><code class="shell">npm 命令 --help//查看指定命令的使用帮助
</code></pre>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>如何解决npm被墙的问题</p>
<ul>
<li><p>安装淘宝的cnpm：</p>
<pre><code>npm install --global cnpm//--global表示安装到全局，不能省略。以后就能用cnpm代替npm了
</code></pre></li>
<li><p>如果不想安装cnpm但是又想用淘宝的服务器下载，可以通过:</p>
<pre><code>npm config set registry https://registry.npm.taobao.org//默认使用淘宝服务器下载
</code></pre></li>
</ul>
</li>
</ul>
<h2 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h2><p>一种Web开发框架</p>
<pre><code>npm install express --save//安装express
</code></pre><p>拿到框架的第一步当然是Hello World！</p>
<pre><code class="javascript">var express=require(&#39;express&#39;)
var app=express()//相当于以前的server对象

app.listen(3000,function(){
    console.log(&#39;服务器，琦动&#39;)
})

app.get(&#39;/&#39;,function(req,res){//以get方法请求&#39;/&#39;，并执行对应的处理函数
    res.send(&#39;Hello World!&#39;)
})
</code></pre>
<h3 id="静态服务（静态-资源获取）"><a href="#静态服务（静态-资源获取）" class="headerlink" title="静态服务（静态 资源获取）"></a>静态服务（静态 资源获取）</h3><pre><code class="javascript">// 开放静态资源
// 1.当以/public/开头的时候，去./public/目录中找对应资源
// 访问：http://127.0.0.1:3000/public/login.html
app.use(&#39;/public/&#39;,express.static(&#39;./public/&#39;)); 

// 2.当省略第一个参数的时候，可以通过省略/public的方式来访问
// 访问：http://127.0.0.1:3000/login.html
// app.use(express.static(&#39;./public/&#39;));   

// 3.访问：http://127.0.0.1:3000/a/login.html
// a相当于public的别名
// app.use(&#39;/a/&#39;,express.static(&#39;./public/&#39;)); 
</code></pre>
<h3 id="在Express中获取表单请求数据"><a href="#在Express中获取表单请求数据" class="headerlink" title="在Express中获取表单请求数据"></a>在Express中获取表单请求数据</h3><h6 id="获取get请求数据："><a href="#获取get请求数据：" class="headerlink" title="获取get请求数据："></a>获取get请求数据：</h6><p>Express内置了一个api，可以直接通过<code>req.query</code>来获取数据</p>
<pre><code class="javascript">// 通过requery方法获取用户输入的数据
// req.query只能拿到get请求的数据
 var comment = req.query;
</code></pre>
<h6 id="获取post请求数据："><a href="#获取post请求数据：" class="headerlink" title="获取post请求数据："></a>获取post请求数据：</h6><p>在Express中没有内置获取表单post请求体的api，这里我们需要使用一个第三方包<code>body-parser</code>来获取数据。</p>
<p>安装：</p>
<pre><code class="javascript">npm install --save body-parser;
</code></pre>
<p>配置：</p>
<p>// 配置解析表单 POST 请求体插件（注意：一定要在 app.use(router) 之前 ）</p>
<pre><code class="javascript">var express = require(&#39;express&#39;)
// 引包
var bodyParser = require(&#39;body-parser&#39;)

var app = express()

// 配置body-parser
// 只要加入这个配置，则在req请求对象上会多出来一个属性：body
// 也就是说可以直接通过req.body来获取表单post请求数据
// parse application/x-www-form-urlencoded
app.use(bodyParser.urlencoded({ extended: false }))

// parse application/json
app.use(bodyParser.json())
</code></pre>
<p>使用：</p>
<pre><code class="javascript">app.use(function (req, res) {
  res.setHeader(&#39;Content-Type&#39;, &#39;text/plain&#39;)
  res.write(&#39;you posted:\n&#39;)
  // 可以通过req.body来获取表单请求数据
  res.end(JSON.stringify(req.body, null, 2))
})
</code></pre>
<h3 id="在express中配合和使用art-template"><a href="#在express中配合和使用art-template" class="headerlink" title="在express中配合和使用art-template"></a>在express中配合和使用<code>art-template</code></h3><p>安装：</p>
<pre><code class="shell">npm install --svae art-template
npm install --save express-art-template
</code></pre>
<p>配置：</p>
<pre><code class="javascript">app.engine(&#39;html&#39;,require(&#39;express-art-template&#39;))//第一个参数表示渲染以art结尾的文件
</code></pre>
<p>使用：</p>
<pre><code class="javascript">app.get(&#39;/&#39;,function(req,res){
    //express默认会从项目的views目录去寻找index.html
    res.render(&#39;index.html&#39;,{
        title:&#39;hello world&#39;
    })
})
</code></pre>
<p>如果希望修改视图渲染的目录（原本是views），可：</p>
<pre><code class="javascript">app.set(&#39;views&#39;,目录路径)
</code></pre>
<h3 id="CRUD-待更…"><a href="#CRUD-待更…" class="headerlink" title="CRUD(待更…)"></a>CRUD(待更…)</h3><h1 id="其他项"><a href="#其他项" class="headerlink" title="其他项"></a>其他项</h1><h2 id="①修改完代码自动重启"><a href="#①修改完代码自动重启" class="headerlink" title="①修改完代码自动重启"></a>①修改完代码自动重启</h2><p>以前每次修改完代码都要傻乎乎地去<code>node xxx.js</code>现在有了nodemon这一个第三方命令行工具，就能解决这一问题。</p>
<p>安装方法，懂得都懂</p>
<pre><code class="shell">npm install nodemon --global
</code></pre>
<h2 id="②封装异步API"><a href="#②封装异步API" class="headerlink" title="②封装异步API"></a>②封装异步API</h2><p>回调函数：获取异步操作的结果</p>
<pre><code class="javascript">function fn(callback){
    // var callback = funtion(data){ console.log(data); }
    setTimeout(function(){
        var data = &#39;hello&#39;;
        callback(data);
    },1000);
}
// 如果需要获取一个函数中异步操作的结果，则必须通过回调函数的方式来获取
fn(function(data){
    console.log(data);
})
</code></pre>
<h2 id="③关于json文件格式の坑"><a href="#③关于json文件格式の坑" class="headerlink" title="③关于json文件格式の坑"></a>③关于json文件格式の坑</h2><p>json文件格式要求极其严格，比如</p>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/err_json.png" alt></p>
<p>致命错误在：id为5的一行<strong><em>末尾的逗号</em></strong>，一定要去掉！！！<strong><em><span style="color:red;font-size:30px">结尾</span></em></strong>的一个花括号不能有逗号（就这个错误折磨了我半个小时……）</p>
<h1 id="小项目"><a href="#小项目" class="headerlink" title="小项目"></a>小项目</h1><p>一个简单的表单提交网站</p>
<h2 id="路由设计"><a href="#路由设计" class="headerlink" title="路由设计"></a>路由设计</h2><table>
<thead>
<tr>
<th>请求方法</th>
<th style="text-align:left">请求路径</th>
<th style="text-align:left">get参数</th>
<th>post参数</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td style="text-align:left">/students</td>
<td style="text-align:left"></td>
<td></td>
<td style="text-align:left">渲染首页</td>
</tr>
<tr>
<td>GET</td>
<td style="text-align:left">/students/new</td>
<td style="text-align:left"></td>
<td></td>
<td style="text-align:left">渲染添加学生页面</td>
</tr>
<tr>
<td>POST</td>
<td style="text-align:left">/students/new</td>
<td style="text-align:left"></td>
<td>name,age,gender,hobbies</td>
<td style="text-align:left">处理添加学生请求</td>
</tr>
<tr>
<td>GET</td>
<td style="text-align:left">/students/edit</td>
<td style="text-align:left">id</td>
<td></td>
<td style="text-align:left">渲染编辑页面</td>
</tr>
<tr>
<td>POST</td>
<td style="text-align:left">/students/edit</td>
<td style="text-align:left"></td>
<td>id,name,age,gender,hobbies</td>
<td style="text-align:left">处理编辑请求</td>
</tr>
<tr>
<td>GET</td>
<td style="text-align:left">/students/delete</td>
<td style="text-align:left">id</td>
<td></td>
<td style="text-align:left">处理删除请求</td>
</tr>
</tbody>
</table>
<h2 id="提取路由模块"><a href="#提取路由模块" class="headerlink" title="提取路由模块"></a>提取路由模块</h2><p>router.js:</p>
<pre><code class="javascript">/**
* router.js路由模块
* 职责：
*      处理路由
*      根据不同的请求方法+请求路径设置具体的请求函数
* 模块职责要单一，我们划分模块的目的就是增强代码的可维护性，提升开发效率
*/
var fs = require(&#39;fs&#39;);

// Express专门提供了一种更好的方式
// 专门用来提供路由的
var express = require(&#39;express&#39;);
// 1 创建一个路由容器
var router = express.Router();
// 2 把路由都挂载到路由容器中

var Students=require(&#39;./student&#39;)

router.get(&#39;/students&#39;, function(req, res) {
    // res.send(&#39;hello world&#39;);
    // readFile的第二个参数是可选的，传入utf8就是告诉他把读取到的文件直接按照utf8编码，直接转成我们认识的字符
    // 除了这样来转换，也可以通过data.toString（）来转换
        Students.find(function(err,students){
            if (err) {
                return res.status(500).send(&#39;Server error.&#39;)
            }

            res.render(&#39;index.html&#39;,{students:students})
        })

});
router.get(&#39;/students/new&#39;,function(req,res){
    res.render(&#39;new.html&#39;)
});

router.post(&#39;/students/new&#39;,function(req,res){
    //获取表单数据
    console.log(JSON.stringify(req.body))
    //处理数据
    //将数据写入json文件
    //发送响应
    //读取json文件并转换为对象--&gt;在对象中添加数据--&gt;将对象转换为字符串--&gt;将字符串写入json文件
    Students.save(req.body,function (err){
        if(err){
            return res.status(500).send(&#39;Server error.&#39;)
        }
        res.redirect(&#39;/&#39;)
    })
});


router.get(&#39;/students/edit&#39;,function(req,res){

});

router.post(&#39;/students/edit&#39;,function(req,res){

});

router.get(&#39;/students/delete&#39;,function(req,res){

});

// 3 把router导出
module.exports = router;
</code></pre>
<p>app.js:</p>
<pre><code class="javascript">var router = require(&#39;./router&#39;);

// router(app);
// 把路由容器挂载到app服务中
// 挂载路由
app.use(router);
</code></pre>
<h2 id="数据操作文件模块"><a href="#数据操作文件模块" class="headerlink" title="数据操作文件模块"></a>数据操作文件模块</h2><pre><code class="javascript">/**
 * student.js
 * 数据操作文件模块
 * 职责：操作文件中的数据，只处理数据，不关心业务
 */
var fs = require(&#39;fs&#39;);
var dbPath = &#39;./db.json&#39;
/**
 * 获取所有学生列表
 * return []
 */
exports.find = function (callback) {
    fs.readFile(dbPath, &#39;utf8&#39;, function (err, data) {
        if (err) {
            return callback(err)
        }
        callback(null, JSON.parse(data).students)
    })
}


/**
 * 获取添加保存学生
 */
exports.save = function (student, callback) {
    fs.readFile(dbPath, &#39;utf8&#39;, function (err, data) {
        if (err) {
            return callback(err)
        }
        //将json字符串转换为数组对象
        var students = JSON.parse(data).students
        //将对象保存到数组对象中
       if (students.length==0) {
            student.id =1
        }
        else{
            student.id=students[students.length-1].id+1
        }
        students.push(student)
        //将数组对象转换为json文件（字符串）
        var newData = JSON.stringify({students: students})
        //字符串写入到文件中
        fs.writeFile(dbPath, newData, function (err) {
            if (err) {
                return callback(err)
            }
            callback(null)
        })
    })
}

/**
 * 更新学生
 */
exports.update = function () {

}

/**
 * 删除学生
 */
exports.delete = function () {

}
</code></pre>
<p>成功插入数据の截图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/add_students.png" alt></p>
<p>点击submit，成功重定向回主页并渲染完成の截图</p>
<p><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/Node_img/students_index.png" alt></p>
<h2 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h2><p>通过这个小项目的练习，可以体会到当进行异步编程时，<strong><em>要想获取异步函数的数据就要使用回调函数</em></strong></p>

        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="alipay-code"><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/AliPayQR.png"></li>
                <li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/WeChanQR.png"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
          <div class="post-tags">
          </div>
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
        
          
            <div class="post-nepre full next">
          
            <a href="/2021/03/03/Preface/" rel="next">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt2.jpeg" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt2.jpeg">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                Preface</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      
<div id="vcomments"></div>
<script>
  window.onload = function(){
      var valine = new Valine();
      valine.init({
        el: '#vcomments',
        appId: "vK4njxg3C8GQOr9L6M8Hav7x-gzGzoHsz",
        appKey: "e9eG1y4IcG54g4l676M1xeWQ",
        path: window.location.pathname,
        placeholder: "整点留言呗"
      })
  }
</script>

      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="https://schema.org/Person">
          <a href="" class="profile gravatar"><img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt3.jpeg" itemprop="image" alt="" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="" itemprop="url" rel="author"></a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i></p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            // PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- <footer id="footer">
  

  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Kitholt Frank<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #666666;">&copy 2021</p>
    </div>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #b9b9b9;">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Sakura</a> <i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> by <a href="https://2heng.xin/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Mashiro</a>&<a href="https://www.hojun.cn/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Hojun</a>, Powered by Hexo, Hosted by Coding Pages</a>
        </span>
      </p>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_uv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人</span>
    </div>
  </div><!-- .site-info -->
    
</footer>







<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/honjun/hojun@1.2","name":"Unbroken.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>
<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
</script>

    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="https://cdn.jsdelivr.net/gh/kitholt/cdn/img/kt3.jpeg">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">KItholtFrank</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="http://github.com/kitholt" class="fa fa-github" target="_blank" style="color: #333; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/categories/技术/">
                  <i class="fa fa-code" aria-hidden="true"></i>
                  技术
                </a>
              </li>
            
              <li>
                <a href="/categories/生活/">
                  <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  生活
                </a>
              </li>
            
              <li>
                <a href="/categories/资源/">
                  <i class="fa fa-cloud-download" aria-hidden="true"></i>
                  资源
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="javascript:;">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
            清单
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/music/">
                  <i class="fa fa-headphones" aria-hidden="true"></i>
                  歌单
                </a>
              </li>
            
              <li>
                <a href="/bangumi/">
                  <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                  番组
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/comment/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
            留言板
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/donate/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
            资瓷
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            关于
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/about/">
                  <i class="fa fa-meetup" aria-hidden="true"></i>
                  我？
                </a>
              </li>
            
          </ul>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2019 hexo-sakura</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<!-- require MetingJS -->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #FF1493;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<meting-js

    id="890672374"

    server="netease"

    type="playlist"

    fixed="true"

    autoplay="false"

    loop="all"

    order="list"

    preload="none"

    volume="0.6"

    mutex="true"

</meting-js>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>
</body>


<script src="https://cdn.jsdelivr.net/gh/Sanarous/files@1.151/js/click.min.js"></script>


<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/piao.js"></script>
 
<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/canvas-nest.min.js"></script>


<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/clickBom.js"></script>



</html>